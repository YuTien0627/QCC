<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ - å–®å¡ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        // Tailwind é…ç½® (é¡è‰²å®šç¾©)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                    colors: {
                        'primary-pink': '#F472B6', 
                        'secondary-purple': '#A78BFA', 
                        'goal-green': '#34D399', 
                        'issue-red': '#F87171', 
                        'bg-paper': '#FFFBEB',
                    }
                }
            }
        }
    </script>

    <style>
        .card-container {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .btn {
            @apply p-4 rounded-xl font-extrabold text-xl shadow-lg transition-all duration-300 transform hover:scale-[1.03] hover:shadow-xl active:scale-[0.98] w-full text-left flex items-start;
            min-height: 80px;
        }

        .btn-pink {
            @apply bg-primary-pink text-white hover:bg-pink-500 border-b-4 border-pink-700/50;
        }

        .btn-purple {
            @apply bg-secondary-purple text-white hover:bg-purple-500 border-b-4 border-purple-700/50;
        }

        .question-title {
            @apply text-3xl font-black text-gray-800 mb-6 border-l-8 border-primary-pink pl-4;
        }

        .history-item {
            @apply inline-flex items-center space-x-2 cursor-pointer transition-colors duration-200;
        }
        .history-item:hover .rewind-text {
            @apply text-primary-pink underline;
        }
    </style>
</head>
<body class="bg-bg-paper p-4 md:p-8 font-sans">

    <div id="decision-app" class="max-w-4xl mx-auto">
        
        <h1 class="text-4xl md:text-5xl font-extrabold text-center text-gray-900 mb-2 mt-4 md:mt-8 tracking-tight">
            å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼
        </h1>
        <p class="text-center text-lg md:text-xl text-gray-600 mb-8 md:mb-12">
            é€éæ±ºç­–æ¨¹ï¼Œè¿…é€Ÿæ‰¾åˆ°æœ€é©åˆæ‚¨çš„å“ç®¡æ–¹æ³•
        </p>

        <div id="history-trail" class="bg-white/70 backdrop-blur-sm p-4 rounded-xl shadow-inner mb-8 min-h-[50px] flex items-center flex-wrap space-x-2 text-sm text-gray-500"></div>

        <div id="question-card-container" class="bg-white p-6 md:p-10 rounded-2xl shadow-2xl border-b-4 border-primary-pink/50 card-container">
            <p class="text-center text-gray-500">æ­£åœ¨è¼‰å…¥æ±ºç­–æ¨¹...</p>
        </div>

        <p class="text-center text-sm text-gray-400 mt-8">
            æ­¤ç‚ºäº’å‹•å¼æ±ºç­–æ¨¹ï¼Œé»æ“Šé¸é …å¾Œå°‡å°å‘ä¸‹ä¸€é—œæˆ–æœ€çµ‚å»ºè­°ã€‚
        </p>
    </div>

    <script>
        // --- æ±ºç­–æ¨¹è³‡æ–™ ---
        const decisionTree = {
            Q1: { 
                title: "ğŸ¾ é—œå¡ä¸€ï¼šæŒ‘æˆ°é¡å‹", 
                question: "æ‚¨æƒ³è™•ç†çš„æ˜¯ã€Œã€å·²ç¶“ç™¼ç”Ÿã€‘çš„éº»ç…©äº‹/å£çµæœã€ (å•é¡Œå‹)ï¼Ÿé‚„æ˜¯ã€æœªä¾†æƒ³é”æˆã€‘çš„æ–°æˆå°±/å¥½æ°´æº– (èª²é¡Œå‹)ï¼Ÿ", 
                icon: "ğŸ¤”", 
                options: [
                    { text: "ğŸ˜­ ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)", next: "Q2", style: "btn-pink" },
                    { text: "ğŸ¤© æœªä¾†ç›®æ¨™æˆ–ä»»å‹™ (èª²é¡Œé”æˆå‹)", next: "R_GOAL", style: "btn-purple" }
                ]
            },
            Q2: { 
                title: "ğŸš¨ é—œå¡äºŒï¼šé é˜²æˆ–è§£æ±º", 
                question: "æ‚¨çš„ç›®æ¨™æ˜¯ã€Œã€é å…ˆã€‘é˜»æ­¢æµç¨‹ä¸­ã€æ½›åœ¨ã€‘çš„é¢¨éšªç™¼ç”Ÿã€å—ï¼Ÿ", 
                icon: "ğŸ›¡ï¸", 
                options: [
                    { text: "ğŸ¯ æ˜¯ï¼Œé å…ˆè©•ä¼°èˆ‡æ§åˆ¶é¢¨éšª (é é˜²é‡)", next: "R_HFMEA", style: "btn-purple" },
                    { text: "ğŸ¤• å¦ï¼Œåˆ†æå·²ç¶“ç™¼ç”Ÿçš„å•é¡Œ (è§£æ¯’åŠ‘)", next: "Q3", style: "btn-pink" }
                ]
            },
            Q3: { 
                title: "ğŸ’¥ é—œå¡ä¸‰ï¼šäº‹ä»¶åš´é‡æ€§", 
                question: "é€™å€‹å•é¡Œæ˜¯ã€Œã€è¶…ç´šåš´é‡ã€‘çš„é‡å¤§/ä¸è‰¯äº‹ä»¶ã€ï¼Œæ‚¨éœ€è¦æ‰¾å‡ºã€ç³»çµ±æ€§çš„æœ€çµ‚åŸå› ã€‘ä¸¦ã€ä¿è­‰ä¸å†ç™¼ç”Ÿã€‘å—ï¼Ÿ", 
                icon: "ğŸ”", 
                options: [
                    { text: "ğŸš€ æ˜¯ï¼Œè¿½æŸ¥æ ¹æœ¬åŸå›  (é‡å¤§ä¸è‰¯äº‹ä»¶)", next: "R_RCA", style: "btn-purple" },
                    { text: "ğŸ§¹ å¦ï¼Œä¸€èˆ¬æ€§ç¼ºå¤±æ”¹å–„ (æ—¥å¸¸å“è³ªæå‡)", next: "R_QCC", style: "btn-pink" }
                ]
            },
            // --- çµæœ ---
            R_GOAL: { 
                title: "ğŸ‰ æ­å–œï¼æ‚¨æ‰¾åˆ°äº†æˆåŠŸé‘°åŒ™ï¼", 
                methodology: "ğŸ’¡ èª²é¡Œé”æˆå‹ (Goal-Achievement)", 
                purpose: "é€™æ–¹æ³•å°ˆé–€å¹«åŠ©æ‚¨å¾ã€Œç¾åœ¨ã€èµ°åˆ°ã€Œç›®æ¨™ã€ã€‚é‡é»æ˜¯ã€ç™¼æ®å‰µæ„æ‰¾æ–¹æ³•ã€‘ï¼Œé”æˆæ‚¨çš„ KPI æˆ–æŒ‘æˆ°ï¼", 
                icon: "ğŸ†", 
                isResult: true, 
                colorClass: "goal-green"
            },
            R_HFMEA: { 
                title: "ğŸ’– é¢¨éšªé˜²è­·ç½©å·²å•Ÿå‹•ï¼", 
                methodology: "ğŸ›¡ï¸ HFMEA (é†«ç™‚å¤±æ•ˆæ¨¡å¼èˆ‡æ•ˆæ‡‰åˆ†æ)", 
                purpose: "é€™å°±åƒæµç¨‹çš„ã€é è­¦é›·é”ã€‘ï¼Œå¹«åŠ©æ‚¨æå‰æ§åˆ¶é¢¨éšªï¼", 
                icon: "ğŸš¨", 
                isResult: true,
                colorClass: "secondary-purple"
            },
            R_RCA: { 
                title: "ğŸ•µï¸â€â™‚ï¸ ç³»çµ±åµæ¢å‡ºå‹•ï¼", 
                methodology: "ğŸ” RCA (æ ¹æœ¬åŸå› åˆ†æ)", 
                purpose: "ç•¶ç™¼ç”Ÿé‡å¤§ä¸è‰¯äº‹ä»¶æ™‚ï¼Œå®ƒæœƒæ‰¾å‡ºç³»çµ±æ€§çš„æ¼æ´ï¼Œé¿å…å†çŠ¯ï¼", 
                icon: "ğŸ¤¯", 
                isResult: true,
                colorClass: "issue-red"
            },
            R_QCC: { 
                title: "ğŸ› ï¸ æ—¥å¸¸å„ªåŒ–å°ˆå®¶å°±æ˜¯æ‚¨ï¼", 
                methodology: "âœ¨ QCC (å•é¡Œè§£æ±ºå‹/å“è³ªæ”¹å–„)", 
                purpose: "æå‡æ—¥å¸¸æµç¨‹å“è³ªçš„ã€è¬ç”¨å·¥å…·ç®±ã€‘ï¼Œç³»çµ±åŒ–ã€Œæ‰¾åŸå›  â†’ è§£æ±ºåŸå› ã€ï¼", 
                icon: "ğŸŒˆ", 
                isResult: true,
                colorClass: "primary-pink"
            }
        };

        // é¡è‰²å°æ‡‰ Tailwind class
        const colorMap = {
            'goal-green': 'bg-goal-green',
            'secondary-purple': 'bg-secondary-purple',
            'issue-red': 'bg-issue-red',
            'primary-pink': 'bg-primary-pink'
        };

        // --- ç‹€æ…‹ ---
        let currentStepKey = "Q1"; 
        let history = [];
        let historyTrailDiv = document.getElementById('history-trail');
        let questionCardContainer = document.getElementById('question-card-container');

        // --- åˆå§‹åŒ– ---
        function initializeToolSelector() {
            renderLadder();
        }

        // --- æ¸²æŸ“å•é¡Œå¡ç‰‡ ---
        function renderQuestion(step) {
            const currentStep = decisionTree[step];
            let html = `<div class="animate-in fade-in zoom-in duration-300">`;
            html += `<h2 class="question-title">${currentStep.icon} ${currentStep.title}</h2>`;
            html += `<p class="text-gray-500 mb-6 text-lg">${currentStep.question}</p>`;
            html += `<div class="space-y-4">`;
            currentStep.options.forEach((option, index) => {
                html += `<button class="btn ${option.style}" onclick="navigate('${option.next}', '${step}', this.textContent)">
                            <span class="text-xl mr-3 font-extrabold">${String.fromCharCode(65 + index)}</span>
                            <span class="flex-grow">${option.text}</span>
                        </button>`;
            });
            html += `</div></div>`;
            questionCardContainer.innerHTML = html;
        }

        // --- æ¸²æŸ“çµæœå¡ç‰‡ ---
        function renderResult(step) {
            const result = decisionTree[step];
            const bgColor = colorMap[result.colorClass] || 'bg-gray-200';

            let html = `<div class="animate-in fade-in zoom-in duration-500 text-center">`;
            html += `<div class="${bgColor} w-24 h-24 mx-auto mb-6 rounded-full flex items-center justify-center animate-bounce-once shadow-2xl">`;
            html += `<span class="text-5xl">${result.icon}</span>`;
            html += `</div>`;
            html += `<h2 class="text-4xl font-extrabold text-gray-900 mb-4">${result.title}</h2>`;
            html += `<div class="inline-block p-4 rounded-xl ${bgColor}/10 border-l-4 border-${result.colorClass} mx-auto max-w-lg mb-6 shadow-md">`;
            html += `<h3 class="text-2xl font-bold text-gray-800 mb-2">${result.methodology}</h3>`;
            html += `<p class="text-gray-600 text-lg">${result.purpose}</p>`;
            html += `</div>`;
            html += `<button class="btn bg-gray-500/80 text-white hover:bg-gray-700 mx-auto mt-6 w-auto px-12 py-3" onclick="navigate('Q1')">ğŸ”„ é‡æ–°æŒ‘æˆ° (å¾é ­é–‹å§‹)</button>`;
            html += `</div>`;

            questionCardContainer.innerHTML = html;
        }

        // --- æ¸²æŸ“æ­·å²è»Œè·¡ ---
        function renderLadder() {
            let html = `<span class="font-bold text-base text-primary-pink mr-2">ğŸ—ºï¸ æ‚¨çš„é¸æ“‡è·¯å¾‘ï¼š</span>`;
            history.forEach((item, index) => {
                html += `<div class="history-item group" onclick="rewindToStep('${item.key}')">
                            <span class="text-primary-pink font-bold">${index+1}.</span>
                            <span class="rewind-text text-gray-600">${item.text}</span>
                            <span class="text-gray-400">Â»</span>
                         </div>`;
            });

            const current = decisionTree[currentStepKey];
            if(current && current.isResult) {
                html += `<span class="text-${current.colorClass} font-bold flex items-center space-x-1">${current.icon} <span>${current.methodology}</span></span>`;
            } else if(current) {
                html += `<span class="text-gray-800 font-bold flex items-center space-x-1">${current.icon} <span>${current.title.split('ï¼š')[0]}</span></span>`;
            }
            historyTrailDiv.innerHTML = html;

            if(current && current.isResult) {
                renderResult(currentStepKey);
            } else if(current) {
                renderQuestion(currentStepKey);
            }
        }

        // --- å°èˆª ---
        function navigate(nextState, questionKey, selectedText) {
            if(questionKey && selectedText) {
                const cleanedText = selectedText.trim().split(/\s+/).slice(1).join(' ').trim();
                history.push({ key: questionKey, selection: nextState, text: cleanedText });
            } else if(nextState === 'Q1') {
                history = [];
            }
            currentStepKey = nextState;
            renderLadder();
        }

        // --- å›æº¯ ---
        function rewindToStep(targetKey) {
            const targetIndex = history.findIndex(item => item.key === targetKey);
            if(targetIndex !== -1) {
                history = history.slice(0, targetIndex);
            }
            currentStepKey = targetKey;
            renderLadder();
        }

        // --- å•Ÿå‹• ---
        initializeToolSelector();
    </script>

</body>
</html>
