<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ - å–®å¡ç‰ˆ</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ----------------------------------------------------- -->
    <!-- æ ¼å¼å€å¡Š (FORMAT BLOCK) -->
    <!-- ----------------------------------------------------- -->
    <script>
        // Tailwind é…ç½® (é¡è‰²å®šç¾©)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                    colors: {
                        // å¯æ„›é¢¨æ ¼çš„é…è‰²
                        'primary-pink': '#F472B6', // ä¸»è‰²èª¿ï¼šå¯æ„›ç²‰
                        'secondary-purple': '#A78BFA', // æ¬¡è¦è‰²èª¿ï¼šå¤¢å¹»ç´«
                        'goal-green': '#34D399', // é”æˆç›®æ¨™ï¼šæ¸…æ–°ç¶ 
                        'issue-red': '#F87171', // å•é¡Œè­¦ç¤ºï¼šæ´»åŠ›ç´…
                        'bg-paper': '#FFFBEB', // èƒŒæ™¯ç´™å¼µè‰²ï¼šå¥¶æ²¹é»ƒ
                    }
                }
            }
        }
    </script>
    <style>
        /* ç¢ºä¿å­—é«”åœ¨ä¸­æ–‡ç’°å¢ƒä¸‹æ­£ç¢ºé¡¯ç¤º */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #FDFCFB 0%, #E2E8F0 100%); /* æŸ”å’ŒèƒŒæ™¯æ¼¸è®Š */
        }

        /* ----------------------------------------------------- */
        /* â˜…â˜…â˜… æ±ºç­–æŒ‰éˆ•æ ¼å¼æ§åˆ¶ä¸­å¿ƒ (BUTTON FORMAT CONTROL) â˜…â˜…â˜… */
        /* ----------------------------------------------------- */
        .btn {
            /* èª¿æ•´ï¼šä½¿ç”¨æœ€å¤§æ¨™æº–å¡«å…… (px-12 py-8)ï¼Œä¸¦å°‡å­—é«”æ”¾å¤§åˆ° text-7xl (æ‰‹æ©Ÿ) / text-8xl (æ¡Œé¢) */
            @apply px-12 py-8 rounded-full font-extrabold text-7xl md:text-8xl transition duration-300 shadow-lg border-b-4 border-opacity-70;
            /* è®“æŒ‰éˆ•åœ¨å°è¢å¹•æ™‚è‡ªå‹•æ›è¡Œ */
            white-space: normal;
        }
        
        /* æŒ‰éˆ•é¡è‰²æ¨£å¼ */
        .btn-pink {
            @apply bg-primary-pink text-white border-primary-pink/80 hover:bg-pink-500 hover:border-pink-600 active:translate-y-1 active:shadow-sm;
        }
        .btn-purple {
            @apply bg-secondary-purple text-white border-secondary-purple/80 hover:bg-violet-500 hover:border-violet-600 active:translate-y-1 active:shadow-sm;
        }
        .btn-reset {
            /* é‡ç½®æŒ‰éˆ•ä½¿ç”¨è¼ƒå°çš„å­—é«”ï¼Œé¿å…éåº¦çªå‡º */
            @apply bg-gray-400 text-white border-gray-500 hover:bg-gray-500 hover:border-gray-600 active:translate-y-1 active:shadow-sm text-base;
        }
        /* ----------------------------------------------------- */
        /* â˜…â˜…â˜… æ±ºç­–æŒ‰éˆ•æ ¼å¼æ§åˆ¶ä¸­å¿ƒ çµæŸ â˜…â˜…â˜… */
        /* ----------------------------------------------------- */


        /* å®šç¾©æ±ºç­–å¡ç‰‡çš„å¯æ„›å‹•ç•«æ•ˆæœ */
        .decision-card {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.3s ease; /* Bouncy transform */
        }
        
        /* è‡ªå®šç¾©å‹•ç•« */
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-popIn {
            animation: popIn 0.5s ease-out;
        }
        
        /* è¶£å‘³å¡ç‰‡æ¨£å¼ï¼šè®“æ±ºç­–å¡ç‰‡æ›´ç«‹é«”æœ‰è¶£ */
        .fun-question-card {
            box-shadow: 10px 10px 0 0 #F472B6, 15px 15px 0 0 #A78BFA; 
            transition: all 0.2s ease-out;
        }
        .fun-question-card:hover {
            transform: translate(-2px, -2px);
            box-shadow: 12px 12px 0 0 #F472B6, 17px 17px 0 0 #A78BFA;
        }

        /* ----------------------------------------------------- */
        /* æ–°å¢ï¼šéºµåŒ…å±‘/æ­·å²ç¯€é»æ¨£å¼ */
        .breadcrumb-node {
            @apply flex items-center bg-secondary-purple text-white text-sm font-semibold px-3 py-1 rounded-full shadow-md;
        }
        .breadcrumb-node-active {
            /* ä½œç”¨æ–¼éçµæœé é¢çš„ç•¶å‰æ­¥é©Ÿ (Q1, Q2, Q3) */
            @apply bg-primary-pink text-white;
        }
        .breadcrumb-node-result {
            /* ä½œç”¨æ–¼çµæœé é¢ (R_...) */
            /* ä½¿ç”¨æ·ºç²‰è‰²èƒŒæ™¯ï¼Œæ·±è‰²æ–‡å­—ï¼Œä½¿å…¶åœ¨æ­·å²è·¯å¾‘ä¸­æ›´çªå‡ºä¸”æ˜“è®€ */
            @apply bg-primary-pink/20 text-gray-800;
        }
        /* ----------------------------------------------------- */
    </style>
</head>
<!-- èª¿æ•´ body classï¼šç§»é™¤ items-centerï¼Œè®“å…§å®¹å¾é ‚éƒ¨é–‹å§‹æµå‹• -->
<body class="min-h-screen flex justify-center p-4">

    <!-- ä¸»å…§å®¹å€å¡Š -->
    <!-- èª¿æ•´ï¼šæ–°å¢ my-auto ä¾†å¯¦ç¾å‚ç›´ç½®ä¸­ï¼Œä¸¦ç¢ºä¿å…§å®¹éé•·æ™‚å¯ä»¥æ­£å¸¸æ²å‹• -->
    <div id="app" class="w-full max-w-4xl bg-bg-paper shadow-2xl rounded-3xl p-6 md:p-12 border-4 border-primary-pink/30 animate-popIn my-auto">
        <!-- æ‡‰ç”¨ç¨‹å¼æ¨™é ­ -->
        <header class="text-center mb-8 md:mb-10">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-3 leading-tight">
                ğŸ› ï¸ å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ ğŸ’¡
            </h1>
            <p class="text-xl text-gray-500 font-medium">
                ä½ é‚„ä¸ç¢ºå®šç”¨ä»€éº¼å·¥å…·å—ï¼è·Ÿè‘—æ­¥é©Ÿèµ°å¹«ä½ æ‰¾åˆ°é©åˆçš„å·¥å…·
            </p>
        </header>

        <!-- æ­·å²ç´€éŒ„/éºµåŒ…å±‘ (æ–°çš„å±•ç¤ºå½¢å¼) -->
        <div id="history-trail" class="flex flex-wrap gap-2 mb-8 items-center justify-center min-h-[40px] border-b pb-4 border-gray-200">
            <!-- æ­·å²ç¯€é»å°‡æœƒè¢«æ¸²æŸ“åœ¨é€™è£¡ -->
        </div>
        
        <!-- ç•¶å‰å•é¡Œå¡ç‰‡å®¹å™¨ -->
        <div id="question-card-container" class="w-full">
            <!-- Loading message or initial content -->
        </div>

        <div id="reset-button-container" class="mt-8 pt-4 border-t border-gray-200 text-center">
            <button class="btn btn-reset px-6 py-3" onclick="navigate('Q1')">
                ğŸ”„ é‡ç½®æŒ‘æˆ°
            </button>
        </div>
    </div>

    <!-- ----------------------------------------------------- -->
    <!-- å…§å®¹å€å¡Š (CONTENT BLOCK) -->
    <!-- ----------------------------------------------------- -->
    <script>
        // --- æ±ºç­–æ¨¹è³‡æ–™çµæ§‹ (Decision Tree Content) ---
        const decisionTree = {
            Q1: { 
                title: "ğŸ¾ é—œå¡ä¸€ï¼šæŒ‘æˆ°é¡å‹", 
                question: "æ‚¨æƒ³è™•ç†çš„æ˜¯ã€Œã€å·²ç¶“ç™¼ç”Ÿã€‘çš„éº»ç…©äº‹/å£çµæœã€ (å•é¡Œå‹)ï¼Ÿé‚„æ˜¯ã€æœªä¾†æƒ³é”æˆã€‘çš„æ–°æˆå°±/å¥½æ°´æº– (èª²é¡Œå‹)ï¼Ÿ", 
                icon: "", 
                options: [
                    { text: " ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)", next: "Q2", style: "btn-pink" },
                    { text: " æœªä¾†ç›®æ¨™æˆ–ä»»å‹™ (èª²é¡Œé”æˆå‹)", next: "R_GOAL", style: "btn-purple" }
                ]
            },
            Q2: { 
                title: "ğŸš¨ é—œå¡äºŒï¼šé é˜²æˆ–è§£æ±º", 
                question: "æ‚¨çš„ç›®æ¨™æ˜¯ã€Œã€é å…ˆã€‘é˜»æ­¢æµç¨‹ä¸­ã€æ½›åœ¨ã€‘çš„é¢¨éšªç™¼ç”Ÿã€å—ï¼Ÿ (åƒæ‰“é é˜²é‡ä¸€æ¨£)", 
                icon: "", 
                options: [
                    { text: " æ˜¯ï¼Œé å…ˆè©•ä¼°èˆ‡æ§åˆ¶é¢¨éšª (é é˜²é‡)", next: "R_HFMEA", style: "btn-purple" },
                    { text: " å¦ï¼Œåˆ†æå·²ç¶“ç™¼ç”Ÿçš„å•é¡Œ (è§£æ¯’åŠ‘)", next: "Q3", style: "btn-pink" }
                ]
            },
            Q3: { 
                title: "ğŸ’¥ é—œå¡ä¸‰ï¼šäº‹ä»¶åš´é‡æ€§", 
                question: "é€™å€‹å•é¡Œæ˜¯ã€Œã€è¶…ç´šåš´é‡ã€‘çš„é‡å¤§/ä¸è‰¯äº‹ä»¶ã€ï¼Œæ‚¨éœ€è¦æ‰¾å‡ºã€ç³»çµ±æ€§çš„æœ€çµ‚åŸå› ã€‘ä¸¦ã€ä¿è­‰ä¸å†ç™¼ç”Ÿã€‘å—ï¼Ÿ", 
                icon: "", 
                options: [
                    { text: " æ˜¯ï¼Œè¿½æŸ¥æ ¹æœ¬åŸå›  (é‡å¤§ä¸è‰¯äº‹ä»¶)", next: "R_RCA", style: "btn-purple" },
                    { text: " å¦ï¼Œä¸€èˆ¬æ€§ç¼ºå¤±æ”¹å–„ (æ—¥å¸¸å“è³ªæå‡)", next: "R_QCC", style: "btn-pink" }
                ]
            },
            
            // --- çµæœé é¢ (Results) ---
            R_GOAL: { title: "ğŸ‰ æ­å–œï¼æ‚¨æ‰¾åˆ°äº†æˆåŠŸé‘°åŒ™ï¼", methodology: "ğŸ’¡ èª²é¡Œé”æˆå‹ (Goal-Achievement)", purpose: "é€™æ–¹æ³•å°ˆé–€å¹«åŠ©æ‚¨å¾ã€Œç¾åœ¨ã€èµ°åˆ°ã€Œç›®æ¨™ã€ã€‚é‡é»æ˜¯ã€ç™¼æ®å‰µæ„æ‰¾æ–¹æ³•ã€‘ï¼Œé”æˆæ‚¨çš„ KPI æˆ–æŒ‘æˆ°ï¼", icon: "ğŸ†", bgColor: "bg-goal-green/15", textColor: "text-goal-green", borderColor: "border-goal-green" },
            R_HFMEA: { title: "ğŸ’– é¢¨éšªé˜²è­·ç½©å·²å•Ÿå‹•ï¼", methodology: "ğŸ›¡ï¸ HFMEA (é†«ç™‚å¤±æ•ˆæ¨¡å¼èˆ‡æ•ˆæ‡‰åˆ†æ)", purpose: "é€™å°±åƒæ˜¯æµç¨‹çš„ã€é è­¦é›·é”ã€‘ã€‚å®ƒèƒ½å¹«åŠ©æ‚¨åœ¨é¢¨éšªç™¼ç”Ÿå‰ï¼Œæ‰¾åˆ°æµç¨‹ä¸­æ‰€æœ‰å¯èƒ½çš„ã€Œåœ°é›·ã€ä¸¦æå‰æ§åˆ¶ï¼Œè®“æµç¨‹æ›´å®‰å…¨ï¼", icon: "ğŸš¨", bgColor: "bg-secondary-purple/15", textColor: "text-secondary-purple", borderColor: "border-secondary-purple" },
            R_RCA: { title: "ğŸ•µï¸â€â™‚ï¸ ç³»çµ±åµæ¢å‡ºå‹•ï¼", methodology: "ğŸ” RCA (æ ¹æœ¬åŸå› åˆ†æ)", purpose: "ç•¶ç™¼ç”Ÿã€é‡å¤§ä¸è‰¯äº‹ä»¶ã€‘æ™‚ï¼Œæ‚¨éœ€è¦é€™å¥—å·¥å…·æ·±å…¥æŒ–æ˜å•é¡Œçš„Root Cause (æ ¹æº)ã€‚å®ƒæœƒæ‰¾å‡ºç³»çµ±æ€§çš„æ¼æ´ï¼Œç¢ºä¿é€™é¡äº‹ä»¶ä¸æœƒå†åœ¨åŒæ¨£çš„åœ°æ–¹è·Œå€’ï¼", icon: "ğŸ¤¯", bgColor: "bg-issue-red/15", textColor: "text-issue-red", borderColor: "border-issue-red" },
            R_QCC: { title: "ğŸ› ï¸ æ—¥å¸¸å„ªåŒ–å°ˆå®¶å°±æ˜¯æ‚¨ï¼", methodology: "âœ¨ QCC (å•é¡Œè§£æ±ºå‹/å“è³ªæ”¹å–„)", purpose: "é€™æ˜¯æ‚¨æå‡æ—¥å¸¸æµç¨‹å“è³ªçš„ã€è¬ç”¨å·¥å…·ç®±ã€‘ï¼ç•¶æœ‰ç¼ºå¤±ã€æŠ±æ€¨æˆ–æ•¸æ“šä¸ä½³æ™‚ï¼Œå®ƒèƒ½å¼•å°æ‚¨ç³»çµ±åŒ–åœ°ã€Œæ‰¾åŸå›  â†’ è§£æ±ºåŸå› ã€ï¼Œè®“ç¾æ³è®Šå¾—æ›´å¥½ï¼", icon: "ğŸŒˆ", bgColor: "bg-primary-pink/15", textColor: "text-primary-pink", borderColor: "border-primary-pink" },
            
            // --- æ–°å¢ï¼šè©³ç´°å¯¦æ–½æ­¥é©Ÿé é¢ (Details) ---
            D_GOAL: {
                title: "ğŸ¯ èª²é¡Œé”æˆå‹ï¼šå¯¦æ–½æ­¥é©Ÿ (PDCA)", icon: "ğŸ†", color: "text-goal-green",
                steps: [
                    { num: 1, title: "PLAN (è¨ˆç•«)ï¼šç¢ºç«‹ç›®æ¨™ã€æ“¬å®šè¨ˆç•«", detail: "æ¸…æ¥šå®šç¾©æƒ³è¦é”æˆçš„ç›®æ¨™å’Œè¡¡é‡æŒ‡æ¨™ (KPI)ã€‚æ ¹æ“šç›®æ¨™ï¼Œè¨­è¨ˆå…·é«”çš„å¯¦æ–½æ­¥é©Ÿå’Œæ™‚ç¨‹ã€‚", icon: "ğŸ“" },
                    { num: 2, title: "DO (åŸ·è¡Œ)ï¼šå¯¦æ–½è¨ˆç•«", detail: "æŒ‰ç…§è¦åŠƒå¥½çš„æ­¥é©Ÿé€²è¡Œæ“ä½œã€‚åœ¨é€™å€‹éšæ®µï¼Œéœ€è¦æŒçºŒç›£æ§é€²åº¦ä¸¦è¨˜éŒ„éç¨‹ä¸­çš„æ•¸æ“šã€‚", icon: "ğŸƒ" },
                    { num: 3, title: "CHECK (æŸ¥æ ¸)ï¼šè©•ä¼°çµæœã€æ¯”è¼ƒå·®ç•°", detail: "æ ¹æ“šç´€éŒ„çš„æ•¸æ“šï¼Œå°‡å¯¦éš›çµæœèˆ‡åŸå…ˆè¨­å®šçš„ç›®æ¨™é€²è¡Œæ¯”è¼ƒï¼Œåˆ†æé”æˆåº¦èˆ‡å·®ç•°åŸå› ã€‚", icon: "ğŸ“Š" },
                    { num: 4, title: "ACT (è™•ç½®)ï¼šæ¨™æº–åŒ–ã€æŒçºŒæ”¹é€²", detail: "å¦‚æœç›®æ¨™é”æˆï¼Œå‰‡å°‡æˆåŠŸçš„ç¶“é©—æ¨™æº–åŒ–ã€‚å¦‚æœæœªé”æˆï¼Œå‰‡èª¿æ•´è¨ˆç•«ï¼Œé–‹å§‹æ–°ä¸€è¼ªçš„ PDCA å¾ªç’°ã€‚", icon: "ğŸ”„" },
                ]
            },
            D_HFMEA: {
                title: "ğŸ›¡ï¸ HFMEAï¼šå¯¦æ–½æ­¥é©Ÿ (é¢¨éšªé è­¦)", icon: "ğŸš¨", color: "text-secondary-purple",
                steps: [
                    { num: 1, title: "ç¢ºç«‹æµç¨‹/æœå‹™ä¸»é¡Œ", detail: "é¸æ“‡ä¸€å€‹éœ€è¦è©•ä¼°é¢¨éšªçš„æµç¨‹ï¼Œå¦‚è—¥ç‰©çµ¦äºˆæµç¨‹ã€è¨­å‚™äº¤æ¥æµç¨‹ç­‰ã€‚", icon: "ğŸ“Œ" },
                    { num: 2, title: "çµ„æˆè·¨è·èƒ½åœ˜éšŠ", detail: "å¬é›†ç†Ÿæ‚‰è©²æµç¨‹çš„å„éƒ¨é–€å°ˆå®¶ï¼Œå…±åŒåƒèˆ‡åˆ†æã€‚", icon: "ğŸ¤" },
                    { num: 3, title: "ç¹ªè£½è©³ç´°æµç¨‹åœ–", detail: "å°‡æµç¨‹æ‹†è§£åˆ°æœ€ç´°éƒ¨çš„æ­¥é©Ÿï¼Œè­˜åˆ¥æ¯å€‹æ­¥é©Ÿçš„ã€æ½›åœ¨å¤±æ•ˆé»ã€ã€‚", icon: "ğŸ—ºï¸" },
                    { num: 4, title: "åˆ†æå¤±æ•ˆæ¨¡å¼èˆ‡å¾Œæœ", detail: "å°æ–¼æ¯å€‹å¤±æ•ˆé»ï¼Œè¨è«–å¯èƒ½å‡ºéŒ¯çš„æ–¹å¼ (Mode) å’Œé€ æˆçš„å¾Œæœ (Effect)ã€‚è¨ˆç®— RPN å€¼ã€‚", icon: "ğŸ’¥" },
                    { num: 5, title: "å¯¦æ–½èˆ‡è©•ä¼°æ§åˆ¶æªæ–½", detail: "é‡å°é«˜ RPN çš„å¤±æ•ˆæ¨¡å¼ï¼Œè¨­è¨ˆé é˜²æ€§çš„æ§åˆ¶æªæ–½ï¼Œä¸¦ç¢ºèªæªæ–½å¯¦æ–½å¾Œçš„é¢¨éšªæ˜¯å¦é™ä½ã€‚", icon: "âœ…" },
                ]
            },
            D_RCA: {
                title: "ğŸ” RCAï¼šå¯¦æ–½æ­¥é©Ÿ (ç³»çµ±åµéŒ¯)", icon: "ğŸ¤¯", color: "text-issue-red",
                steps: [
                    { num: 1, title: "ç•Œå®šèˆ‡æè¿°å•é¡Œ", detail: "æ¸…æ™°åœ°å®šç¾©ã€ä»€éº¼ç™¼ç”Ÿäº†ï¼Ÿèª°/åœ¨å“ªè£¡ï¼Ÿä½•æ™‚ï¼Ÿåš´é‡æ€§ï¼Ÿã€ï¼Œä¸¦è¨­å®šèª¿æŸ¥ç¯„åœã€‚", icon: "ğŸ“‹" },
                    { num: 2, title: "æ”¶é›†è³‡æ–™èˆ‡è­‰æ“š", detail: "æ”¶é›†æ‰€æœ‰ç›¸é—œæ–‡ä»¶ã€ç´€éŒ„ã€è¨ªè«‡è³‡æ–™ï¼Œé‡å»ºäº‹ä»¶çš„ç™¼ç”Ÿç¶“éã€‚", icon: "ğŸ“‚" },
                    { num: 3, title: "æ‰¾å‡ºæ ¹æœ¬åŸå› ", detail: "ä½¿ç”¨ 5 Whysã€é­šéª¨åœ–ç­‰å·¥å…·ï¼ŒæŒçºŒå‘ä¸‹è¿½å•ï¼Œå¾ç›´æ¥åŸå› æ‰¾åˆ°æ½›åœ¨çš„ç³»çµ±æ€§åŸå› ã€‚", icon: "â“" },
                    { num: 4, title: "åˆ¶å®šèˆ‡å¯¦æ–½ç³¾æ­£æªæ–½", detail: "æªæ–½æ‡‰é‡å°ã€æ ¹æœ¬åŸå› ã€è€Œéç—‡ç‹€ã€‚è¨­è¨ˆå¤šé‡é˜²è­·æ©Ÿåˆ¶ (Barrier) ä¾†é˜²æ­¢å†ç™¼ã€‚", icon: "ğŸ”§" },
                    { num: 5, title: "è©•ä¼°çµæœèˆ‡æ¨™æº–åŒ–", detail: "ç¢ºèªæªæ–½å¯¦æ–½å¾Œçš„æˆæ•ˆã€‚å°‡æœ‰æ•ˆçš„æ–°æµç¨‹æˆ–è¦å®šç´å…¥æ¨™æº–ä½œæ¥­ï¼Œç¢ºä¿æŒçºŒæ€§ã€‚", icon: "ğŸ“œ" },
                ]
            },
            D_QCC: {
                title: "âœ¨ QCCï¼šå¯¦æ–½æ­¥é©Ÿ (æ—¥å¸¸å„ªåŒ–)", icon: "ğŸŒˆ", color: "text-primary-pink",
                steps: [
                    { num: 1, title: "é¸å®šä¸»é¡Œ", detail: "å¾æ—¥å¸¸æ•¸æ“šæˆ–æŠ±æ€¨ä¸­ï¼Œé¸æ“‡ä¸€å€‹å…·é«”ã€å¯æ”¹å–„çš„å“è³ªå•é¡Œä½œç‚ºä¸»é¡Œã€‚", icon: "ğŸ¯" },
                    { num: 2, title: "ç¾ç‹€æŠŠæ¡èˆ‡ç›®æ¨™è¨­å®š", detail: "æ”¶é›†æ•¸æ“šï¼Œç¢ºèªå•é¡Œçš„åš´é‡ç¨‹åº¦èˆ‡ç¯„åœã€‚è¨­å®šæ˜ç¢ºçš„æ”¹å–„ç›®æ¨™ã€‚", icon: "ğŸ“ˆ" },
                    { num: 3, title: "åˆ†æåŸå› ", detail: "ä½¿ç”¨å±¤åˆ¥æ³•ã€æŸæ‹‰åœ–ã€é­šéª¨åœ–ç­‰å·¥å…·ï¼Œå¾çœ¾å¤šåŸå› ä¸­æ‰¾å‡ºã€ä¸»è¦åŸå› ã€ã€‚", icon: "ğŸ§ " },
                    { num: 4, title: "åˆ¶å®šå°ç­–èˆ‡å¯¦æ–½", detail: "é‡å°ä¸»è¦åŸå› ï¼Œæå‡ºå¤šç¨®è§£æ±ºæ–¹æ¡ˆï¼Œé¸æ“‡æœ€ä½³å°ç­–ä¸¦åŸ·è¡Œã€‚", icon: "ğŸ’¡" },
                    { num: 5, title: "æ•ˆæœç¢ºèªèˆ‡æ¨™æº–åŒ–", detail: "å†æ¬¡æ”¶é›†æ•¸æ“šï¼Œç¢ºèªå°ç­–æ˜¯å¦æœ‰æ•ˆé”æˆç›®æ¨™ã€‚å°‡æˆåŠŸçš„åšæ³•å¯«å…¥æ¨™æº–ä½œæ¥­ã€‚", icon: "ğŸ’¯" },
                ]
            }
        };
        // --- æ±ºç­–æ¨¹è³‡æ–™çµæ§‹ (Decision Tree Content) çµæŸ ---


        // --- æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ç®¡ç† (Logic for running the app) ---
        let currentStepKey = "Q1";
        // Tracks the path taken: [{key: "Q1", selection: "Q2", text: "ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)"}, ...]
        let history = []; 
        const historyTrailDiv = document.getElementById('history-trail'); // æ­·å²ç´€éŒ„å®¹å™¨
        const questionCardContainer = document.getElementById('question-card-container'); // ç•¶å‰å•é¡Œå®¹å™¨

        // -----------------------------------------------------------------
        // â˜…â˜…â˜… æ–°å¢ï¼šå¤–éƒ¨é é¢è¼‰å…¥å‡½æ•¸ (Mimics External Page Load) â˜…â˜…â˜…
        // -----------------------------------------------------------------

        /**
         * é¡¯ç¤ºè‡ªå®šç¾©è¨Šæ¯æ¡†ï¼ˆå–ä»£ alert()ï¼‰
         * @param {string} message - è¦é¡¯ç¤ºçš„è¨Šæ¯
         */
        function showMessage(message) {
            let messageBox = document.getElementById('message-box');
            if (!messageBox) {
                messageBox = document.createElement('div');
                messageBox.id = 'message-box';
                // ä½¿ç”¨ Tailwind æ¨£å¼ï¼Œä½¿å…¶çœ‹èµ·ä¾†åƒä¸€å€‹æˆåŠŸçš„ Toast
                messageBox.className = 'fixed top-4 right-4 z-50 p-4 rounded-lg shadow-xl text-white bg-indigo-500 transition-opacity duration-300 opacity-0 transform translate-x-10';
                document.body.appendChild(messageBox);
            }
            
            messageBox.textContent = message;
            messageBox.classList.remove('opacity-0', 'translate-x-10');
            messageBox.classList.add('opacity-100', 'translate-x-0');
            
            // 3 ç§’å¾Œéš±è—
            setTimeout(() => {
                messageBox.classList.remove('opacity-100', 'translate-x-0');
                messageBox.classList.add('opacity-0', 'translate-x-10');
            }, 3000);
        }

        /**
         * æ¨¡æ“¬å¤–éƒ¨é é¢è¼‰å…¥ï¼Œå¯¦å‰‡å°èˆªåˆ°è©³ç´°æ­¥é©Ÿ (æ ¹æ“šæ‚¨çš„è¦æ±‚æ–°å¢)
         * @param {string} targetFile - æ¨¡æ“¬çš„ç›®æ¨™æ–‡ä»¶åç¨± (e.g., 'æ›¸é¢æ ¼å¼_å•é¡Œå‹.html')
         * @param {string} resultKey - ç•¶å‰çš„çµæœæ­¥é©Ÿéµ (e.g., 'R_RCA', 'R_GOAL')
         */
        function loadExternalPage(targetFile, resultKey) {
            // æ ¹æ“šçµæœéµ R_XXX å°èˆªåˆ°å…§éƒ¨ D_XXX è©³ç´°æ­¥é©Ÿ
            const detailKey = 'D_' + resultKey.split('_')[1];
            
            // åŸ·è¡Œå…§éƒ¨å°èˆª
            navigate(detailKey);
            
            // é¡¯ç¤ºè¨Šæ¯ï¼Œæ¨¡æ“¬é é¢è·³è½‰
            showMessage(`æ¨¡æ“¬è·³è½‰åˆ°å¤–éƒ¨æ–‡ä»¶ï¼šã€${targetFile}ã€‘`);
        }

        // --- æ¸²æŸ“å·¥å…·å‡½æ•¸ (Rendering Helpers) ---
        
        /** å–å¾—æ­¥é©Ÿçš„ç°¡çŸ­æ¨™é¡Œ */
        function getStepTitle(key) {
            if (key === 'Q1') return "æŒ‘æˆ°é¡å‹";
            if (key === 'Q2') return "é é˜²æˆ–è§£æ±º";
            if (key === 'Q3') return "äº‹ä»¶åš´é‡æ€§";
            if (key.startsWith('R_')) return "å»ºè­°å·¥å…·";
            if (key.startsWith('D_')) return "è©³ç´°æ­¥é©Ÿ";
            return "é–‹å§‹";
        }

        /** æ¸²æŸ“ä¸€å€‹å·²å®Œæˆçš„æ­¥é©Ÿç¯€é» (æ°´å¹³éºµåŒ…åŒ…å±‘æ¨£å¼) */
        function renderCompletedNode(item, index) {
            const stepTitle = getStepTitle(item.key);
            const stepNumber = index + 1; // å¾ 1 é–‹å§‹ç·¨è™Ÿ
            
            // å¦‚æœæ˜¯çµæœé é¢ï¼Œå‰‡ä¸é¡¯ç¤ºé¸æ“‡å…§å®¹ï¼Œåªé¡¯ç¤ºå·¥å…·åç¨±
            const isResult = item.key.startsWith('R_');
            const resultData = isResult ? decisionTree[item.key] : null;
            const selectionText = isResult 
                ? resultData.methodology.split('(')[0] // åªå–å·¥å…·åç¨±
                : item.text.split(' ')[0]; // å–ç¬¬ä¸€å€‹è©
            
            const nodeClasses = isResult ? 'breadcrumb-node-result' : 'breadcrumb-node';

            const nodeHtml = `
                <div class="flex items-center">
                    <!-- ç¯€é»æ¨™é¡Œå’Œé¸æ“‡ -->
                    <button class="${nodeClasses} group" onclick="rewindToStep('${item.key}')" title="é»æ“Šå›åˆ°æ­¤æ­¥é©Ÿ">
                        <span class="mr-2 opacity-80 group-hover:opacity-100">${stepNumber}. ${stepTitle}</span>
                        <!-- ç°¡çŸ­çš„é¸æ“‡å…§å®¹ -->
                        <span class="font-normal text-xs opacity-70 group-hover:opacity:90">(${selectionText})</span>
                    </button>
                    <!-- åˆ†éš”ç¬¦è™Ÿ -->
                    <span class="text-secondary-purple mx-1.5 md:mx-2 text-2xl font-bold">Â»</span>
                </div>
            `;
            return nodeHtml;
        }

        /** æ¸²æŸ“ç›®å‰æ­£åœ¨äº’å‹•çš„å•ç­”å¡ç‰‡ */
        function renderCurrentQuestion(step, stepKey) {
            const stepNumber = stepKey.replace('Q', '');
            
            // å®šç¾©æ¯å€‹æŒ‰éˆ•æ¨£å¼å°æ‡‰çš„åº•è‰²å’Œé‚Šæ¡†
            const bgColors = {
                'btn-pink': 'bg-primary-pink/10 border-primary-pink/30', // ç²‰è‰²æŒ‰éˆ•é…æ·ºç²‰è‰²åº•
                'btn-purple': 'bg-secondary-purple/10 border-secondary-purple/30', // ç´«è‰²æŒ‰éˆ•é…æ·ºç´«è‰²åº•
            };
            
            return `
                <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl border-4 border-primary-pink/50 w-full decision-card animate-popIn fun-question-card">
                    
                    <div class="text-center mb-8">
                        <span class="text-6xl mb-4 block">${step.icon}</span>
                        <!-- ç¢ºä¿æ¨™é¡Œå­—é«”å¤§å°è¶³å¤  -->
                        <h2 class="text-2xl md:text-4xl font-extrabold text-gray-800">${stepNumber}. ${step.title}</h2>
                    </div>

                    <!-- å•é¡Œæè¿°æ–‡å­— (èª¿æ•´ç‚º text-2xl) -->
                    <div class="text-2xl text-gray-700 mb-10 p-6 md:p-8 bg-pink-50 border-4 border-primary-pink rounded-2xl shadow-inner font-medium leading-relaxed text-center">
                        ${step.question}
                    </div>
                    
                    <!-- é¸é …æŒ‰éˆ•å®¹å™¨ (æ¯å€‹é¸é …ä½œç‚ºä¸€å€‹ç¨ç«‹çš„å¡ç‰‡) -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                        ${step.options.map(option => `
                            <!-- å–®å€‹é¸é …å¡ç‰‡åŒ…è£ (ç¨ç«‹åº•è‰²) -->
                            <div class="p-5 rounded-2xl shadow-xl border-4 ${bgColors[option.style] || 'bg-gray-100 border-gray-300'} hover:shadow-2xl transition duration-300 transform hover:-translate-y-0.5">
                                <button 
                                    class="btn w-full ${option.style}" 
                                    onclick="navigate('${option.next}', '${stepKey}', '${option.text}')"
                                >
                                    ${option.text}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        /** æ¸²æŸ“æœ€çµ‚çµæœå¡ç‰‡ */
        function renderFinalResult(result, currentKey) {
            // --- ç¢ºå®šå¤–éƒ¨æ–‡ä»¶åç¨±èˆ‡æ¨£å¼ (ç¬¦åˆä½¿ç”¨è€…éœ€æ±‚) ---
            let fileName = 'è©³ç´°æ­¥é©Ÿ.html';
            let targetIcon = 'â–¶ï¸';
            let buttonStyle = 'bg-primary-pink text-white border-b-4 border-pink-700 hover:bg-pink-600';
            
            if (currentKey === 'R_RCA' || currentKey === 'R_QCC') {
                fileName = 'æ›¸é¢æ ¼å¼_å•é¡Œå‹.html'; // å•é¡Œè§£æ±ºå‹
                targetIcon = 'ğŸ“';
                buttonStyle = 'bg-issue-red text-white border-b-4 border-red-700 hover:bg-red-600';
            } else if (currentKey === 'R_GOAL') {
                fileName = 'æ›¸é¢æ ¼å¼_èª²é¡Œå‹.html'; // èª²é¡Œé”æˆå‹
                targetIcon = 'ğŸ“';
                buttonStyle = 'bg-goal-green text-white border-b-4 border-green-700 hover:bg-green-600';
            } else if (currentKey === 'R_HFMEA') {
                fileName = 'æ›¸é¢æ ¼å¼_é é˜²å‹.html'; // é¢¨éšªé é˜²å‹
                targetIcon = 'ğŸ“';
                buttonStyle = 'bg-secondary-purple text-white border-b-4 border-violet-700 hover:bg-violet-600';
            }
            
            // The detail key remains D_XXX for internal navigation
            // const detailKey = 'D_' + currentKey.split('_')[1]; // è¨»é‡‹æ‰ï¼Œæ”¹ç”¨ loadExternalPage è™•ç†å°èˆª

            return `
                <div class="${result.bgColor} p-6 md:p-12 rounded-3xl shadow-2xl border-t-8 ${result.borderColor} w-full decision-card animate-popIn">

                    <div class="text-center mb-6">
                        <span class="text-8xl mb-4 block animate-bounce-once">${result.icon}</span>
                        <!-- åŠ å¤§çµæœæ¨™é¡Œå­—é«” -->
                        <h2 class="text-4xl md:text-5xl font-extrabold ${result.textColor} mb-4">${result.title}</h2>
                        
                        <!-- å¼·èª¿æœ€çµ‚å»ºè­°çš„å·¥å…· -->
                        <div class="inline-block bg-white/70 p-4 rounded-xl border-4 border-dashed ${result.borderColor} shadow-lg">
                           <p class="text-2xl md:text-4xl font-extrabold text-gray-800">
                                âœ… å»ºè­°æ‚¨æ¡ç”¨ï¼š${result.methodology}
                            </p>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl border-2 ${result.borderColor}/50 shadow-inner mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-3 border-b-2 pb-2">ğŸ¯ ç›®çš„èˆ‡é‡é»æ‘˜è¦</h3>
                        <!-- åŠ å¤§ç›®çš„æè¿°å­—é«” -->
                        <p class="text-xl text-gray-600 leading-relaxed">${result.purpose}</p>
                    </div>

                    <p class="text-base text-center text-gray-500 mb-4 font-semibold">
                        æ­å–œæ‚¨å®Œæˆè©•ä¼°ï¼é»æ“Šä¸‹æ–¹æŒ‰éˆ•æŸ¥çœ‹è©³ç´°çš„å¯¦æ–½æµç¨‹ã€‚
                    </p>
                    
                    <!-- å‰å¾€æ­¥é©ŸæŒ‰éˆ• (å·²ä¿®æ”¹ç‚ºä½¿ç”¨ loadExternalPage å‡½æ•¸å’Œ ID) -->
                    <div class="text-center space-y-4">
                        <button id="nav-btn-form"
                            onclick="loadExternalPage('${fileName}', '${currentKey}')"
                            class="${buttonStyle} active:translate-y-1 active:shadow-sm text-lg font-bold px-8 py-3 rounded-full shadow-md transition duration-300 w-full md:w-auto">
                            ${targetIcon} å‰å¾€ã€${result.methodology.split('(')[0]}ã€‘${fileName}
                        </button>
                    </div>
                    <!-- --------------------- -->
                </div>
            `;
        }

        /** æ¸²æŸ“è©³ç´°å¯¦æ–½æ­¥é©Ÿå¡ç‰‡ (æ–°å¢) */
        function renderDetailedSteps(data, detailKey) {
            // D_GOAL -> R_GOAL
            const resultKey = 'R_' + detailKey.split('_')[1];
            const resultData = decisionTree[resultKey];

            return `
                <div class="bg-white p-6 md:p-10 rounded-3xl shadow-2xl border-4 border-secondary-purple/50 w-full decision-card animate-popIn">
                    
                    <div class="text-center mb-8">
                        <span class="text-6xl mb-4 block ${data.color}">${data.icon}</span>
                        <h2 class="text-3xl md:text-4xl font-extrabold text-gray-800 mb-3">${data.title}</h2>
                        <p class="text-xl text-gray-600 font-medium">â€” ${resultData.methodology} â€”</p>
                    </div>

                    <!-- æ­¥é©Ÿåˆ—è¡¨ -->
                    <div class="space-y-6">
                        ${data.steps.map(step => `
                            <div class="flex items-start bg-bg-paper p-4 md:p-6 rounded-xl border-l-8 border-secondary-purple shadow-md">
                                <div class="mr-4 text-3xl flex-shrink-0">
                                    ${step.icon}
                                </div>
                                <div>
                                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-1">${step.num}. ${step.title}</h3>
                                    <p class="text-sm md:text-base text-gray-600 leading-relaxed">${step.detail}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <!-- è¿”å›æŒ‰éˆ• -->
                    <div class="mt-10 text-center">
                        <button class="bg-secondary-purple text-white border-b-4 border-violet-700 hover:bg-violet-600 active:translate-y-1 active:shadow-sm text-lg font-bold px-8 py-3 rounded-full shadow-md transition duration-300 w-full md:w-auto"
                            onclick="navigate('${resultKey}')">
                            â†©ï¸ è¿”å›ã€${resultData.methodology}ã€‘çµæœæ‘˜è¦
                        </button>
                    </div>
                </div>
            `;
        }


        // --- ä¸»æ¸²æŸ“å‡½æ•¸ (Main Render Function) ---
        function renderLadder() {
            // 1. æ¸²æŸ“æ­·å²ç´€éŒ„ (éºµåŒ…å±‘)
            const questionHistory = history.filter(item => item.key.startsWith('Q'));
            const resultHistory = history.find(item => item.key.startsWith('R_')) || (currentStepKey.startsWith('R_') ? { key: currentStepKey } : null);
            
            let historyHtml = questionHistory.map(renderCompletedNode).join('');
            
            // å¦‚æœå·²ç¶“æœ‰çµæœï¼Œå‰‡å°‡çµæœä½œç‚ºå·²å®Œæˆæ­¥é©ŸåŠ å…¥æ­·å² trail
            if (resultHistory && !currentStepKey.startsWith('R_') && !currentStepKey.startsWith('D_')) {
                historyHtml += renderCompletedNode(resultHistory, questionHistory.length);
            }
            
            // è™•ç†ç•¶å‰æ­¥é©Ÿçš„æ¨™è¨˜
            const isQuestion = currentStepKey.startsWith('Q');
            const isResult = currentStepKey.startsWith('R_');
            const isDetail = currentStepKey.startsWith('D_');
            
            let currentStepText;
            let currentStepClasses; 

            if (isDetail) {
                 // è©³ç´°æ­¥é©Ÿé ï¼šé¡¯ç¤ºå·¥å…·åç¨± + (è©³ç´°æ­¥é©Ÿ)
                const detailData = decisionTree[currentStepKey];
                const resultKey = 'R_' + currentStepKey.split('_')[1];
                const methodology = decisionTree[resultKey].methodology.split('(')[0];
                currentStepText = `${methodology} (è©³ç´°æ­¥é©Ÿ)`;
                currentStepClasses = 'breadcrumb-node-active bg-primary-pink/90'; // ç‰¹åˆ¥é†’ç›®
            } else if (isResult) {
                // çµæœé ï¼šé¡¯ç¤ºæœ€çµ‚æ¨è–¦çš„å·¥å…·åç¨± (æ·ºè‰²)
                const resultData = decisionTree[currentStepKey];
                currentStepText = `æœ€çµ‚æ¨è–¦ï¼š${resultData.methodology.split('(')[0]}`;
                currentStepClasses = 'breadcrumb-node-result'; 
            } else if (isQuestion) {
                // å•ç­”é ï¼šé¡¯ç¤ºé—œå¡åç¨± (æ·±ç²‰è‰²)
                const currentStepTitle = getStepTitle(currentStepKey);
                currentStepText = `${questionHistory.length + 1}. ${currentStepTitle} (é€²è¡Œä¸­)`;
                currentStepClasses = 'breadcrumb-node-active';
            } else {
                 // åˆå§‹æˆ–å…¶ä»–
                currentStepText = "é–‹å§‹";
                currentStepClasses = 'breadcrumb-node-active';
            }
            
            const currentStepHtml = `
                <div class="flex items-center">
                    <span class="breadcrumb-node ${currentStepClasses}">
                        ${currentStepText}
                    </span>
                </div>
            `;
            
            historyTrailDiv.innerHTML = historyHtml + currentStepHtml;


            // 2. æ¸²æŸ“ç•¶å‰å•é¡Œæˆ–çµæœå¡ç‰‡
            questionCardContainer.innerHTML = '';
            const stepData = decisionTree[currentStepKey];
            let cardHtml = '';

            if (isDetail) {
                cardHtml = renderDetailedSteps(stepData, currentStepKey);
            } else if (isResult) {
                cardHtml = renderFinalResult(stepData, currentStepKey);
            } else if (isQuestion) {
                cardHtml = renderCurrentQuestion(stepData, currentStepKey);
            } else {
                cardHtml = `<div class="text-red-500 text-center p-10">éŒ¯èª¤ï¼šæ‰¾ä¸åˆ°æ­¥é©Ÿ ${currentStepKey}</div>`;
            }
            
            questionCardContainer.innerHTML = cardHtml;

            // ç¢ºä¿é é¢æ»¾å‹•åˆ°æœ€ä¸Šæ–¹
            document.getElementById('app').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- å°èˆªå‡½æ•¸ (Navigation Function) ---
        // åªæœ‰ Q1, Q2, Q3 çš„é¸æ“‡æ‰æœƒè¢«è¨˜éŒ„åˆ° history è£¡
        function navigate(nextState, questionKey, selectedText) {
            // åªæœ‰å•ç­”æ­¥é©Ÿ (Q1, Q2, Q3) æ‰éœ€è¦è¨˜éŒ„åœ¨æ­·å²è·¯å¾‘ä¸­
            if (questionKey && questionKey.startsWith('Q') && decisionTree[questionKey]) {
                // æª¢æŸ¥æ˜¯å¦å›åˆ°éå»æ­¥é©Ÿï¼Œå¦‚æœæ˜¯ï¼Œå‰‡å…ˆæˆªæ–·æ­·å² (é¿å…é‡è¤‡è¨˜éŒ„)
                const targetIndex = history.findIndex(item => item.key === questionKey);
                if (targetIndex !== -1) {
                     history = history.slice(0, targetIndex);
                }
                
                // è¨˜éŒ„ç•¶å‰æ­¥é©Ÿå’Œé¸æ“‡çš„çµæœ
                history.push({ key: questionKey, selection: nextState, text: selectedText });

                // å¦‚æœä¸‹ä¸€å€‹ç‹€æ…‹æ˜¯ R_XXXï¼Œä¹Ÿè¦å°‡ R_XXX è¨˜éŒ„åœ¨ history ä¸­ï¼Œä»¥ä¾¿åœ¨éºµåŒ…å±‘ä¸­é¡¯ç¤º
                if (nextState.startsWith('R_')) {
                    history.push({ key: nextState, selection: '', text: decisionTree[nextState].methodology });
                }

            } else if (nextState === 'Q1') {
                // é€™æ˜¯é‡ç½®é‚è¼¯
                history = [];
            }
            // å¦‚æœæ˜¯å¾çµæœé å°èˆªåˆ°è©³ç´°é ï¼Œæˆ–æ˜¯å¾è©³ç´°é å°èˆªå›çµæœé ï¼Œä¸å½±éŸ¿ history å †ç–Šï¼Œåªæ”¹è®Š currentStepKey
            
            currentStepKey = nextState;
            renderLadder();
        }

        // --- å›æº¯å‡½æ•¸ (Rewind Function) ---
        function rewindToStep(targetKey) {
            // å›æº¯æ™‚ï¼Œåªä¿ç•™åˆ°ç›®æ¨™æ­¥é©Ÿä¹‹å‰çš„ Q æ­¥é©Ÿ
            let targetIndex = history.findIndex(item => item.key === targetKey);
            
            if (targetIndex !== -1) {
                // å¦‚æœç›®æ¨™æ˜¯ R_XXXï¼Œç¢ºä¿å›æº¯åˆ°ç”¢ç”Ÿ R_XXX çš„ Q æ­¥é©Ÿ
                if (targetKey.startsWith('R_')) {
                    const originatingQ = history.slice(0, targetIndex).reverse().find(item => item.key.startsWith('Q'));
                    if (originatingQ) {
                        targetIndex = history.findIndex(item => item.key === originatingQ.key);
                    }
                }
                
                // æˆªæ–·æ­·å²ï¼Œåªä¿ç•™åˆ°ç›®æ¨™æ­¥é©Ÿä¹‹å‰çš„éƒ¨åˆ†
                history = history.slice(0, targetIndex);
                // å°èˆªåˆ°ç›®æ¨™æ­¥é©Ÿ
                currentStepKey = targetKey.startsWith('R_') ? targetKey : history[targetIndex - 1]?.selection || targetKey;
                
                // å¼·åˆ¶å°èˆªåˆ°ç›®æ¨™æ­¥é©Ÿ
                currentStepKey = targetKey;

                renderLadder();
            }
        }

        // æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚ï¼Œå°èˆªåˆ°ç¬¬ä¸€å€‹å•é¡Œ
        (function init() {
             // å®šç¾©è®“çµæœåœ–ç¤ºå½ˆè·³ä¸€æ¬¡çš„ CSS å‹•ç•«
            const style = document.createElement('style');
            style.innerHTML += `
                .animate-bounce-once {
                    animation: bounce 0.8s ease-in-out 1;
                }
                @keyframes bounce {
                    0%, 100% { transform: translateY(0); }
                    20% { transform: translateY(-15px); }
                    40% { transform: translateY(0); }
                    60% { transform: translateY(-7px); }
                    80% { transform: translateY(0); }
                }
            `;
            document.head.appendChild(style);
            
            // è®“ rewindToStep, loadExternalPage å¯ä»¥åœ¨å…¨åŸŸç’°å¢ƒä¸­ä½¿ç”¨
            window.rewindToStep = rewindToStep; 
            window.loadExternalPage = loadExternalPage; // ç¢ºä¿æ–°å‡½æ•¸å¯è¢«å…¨åŸŸèª¿ç”¨

            navigate('Q1'); // ç«‹å³æ¸²æŸ“ç¬¬ä¸€å€‹æ­¥é©Ÿ
        })();
    </script>

</body>
</html>
