<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ - å–®å¡ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Tailwind é…ç½® (é¡è‰²å®šç¾©)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                    colors: {
                        // å¯æ„›é¢¨æ ¼çš„é…è‰²
                        'primary-pink': '#F472B6', // ä¸»è‰²èª¿ï¼šå¯æ„›ç²‰
                        'secondary-purple': '#A78BFA', // æ¬¡è¦è‰²èª¿ï¼šå¤¢å¹»ç´«
                        'goal-green': '#34D399', // é”æˆç›®æ¨™ï¼šæ¸…æ–°ç¶ 
                        'issue-red': '#F87171', // å•é¡Œè­¦ç¤ºï¼šæ´»åŠ›ç´…
                        'bg-paper': '#FFFBEB', // èƒŒæ™¯ç´™å¼µè‰²ï¼šå¥¶æ²¹é»ƒ
                    }
                }
            }
        }
    </script>
    <style>
        /* ä¸»è¦å¡ç‰‡å®¹å™¨çš„æ¨£å¼ */
        .card-container {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* æŒ‰éˆ•åŸºç¤æ¨£å¼ */
        .btn {
            @apply p-4 rounded-xl font-extrabold text-xl shadow-lg transition-all duration-300 transform hover:scale-[1.03] hover:shadow-xl active:scale-[0.98] w-full text-left flex items-start;
            min-height: 80px; /* ç¢ºä¿æŒ‰éˆ•é«˜åº¦è¶³å¤  */
        }
        
        /* ç²‰è‰²ä¸»é¡ŒæŒ‰éˆ• */
        .btn-pink {
            @apply bg-primary-pink text-white hover:bg-pink-500 border-b-4 border-pink-700/50;
        }
        
        /* ç´«è‰²ä¸»é¡ŒæŒ‰éˆ• */
        .btn-purple {
            @apply bg-secondary-purple text-white hover:bg-purple-500 border-b-4 border-purple-700/50;
        }

        /* æ¨™é¡Œæ¨£å¼ */
        .question-title {
            @apply text-3xl font-black text-gray-800 mb-6 border-l-8 border-primary-pink pl-4;
        }

        /* æ­·å²è»Œè·¡æ¨£å¼ */
        .history-item {
            @apply inline-flex items-center space-x-2 cursor-pointer transition-colors duration-200;
        }
        .history-item:hover .rewind-text {
            @apply text-primary-pink underline;
        }
    </style>
</head>
<body class="bg-bg-paper p-4 md:p-8 font-sans">

    <div id="decision-app" class="max-w-4xl mx-auto">
        
        <h1 class="text-4xl md:text-5xl font-extrabold text-center text-gray-900 mb-2 mt-4 md:mt-8 tracking-tight">
            å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼
        </h1>
        <p class="text-center text-lg md:text-xl text-gray-600 mb-8 md:mb-12">
            é€éæ±ºç­–æ¨¹ï¼Œè¿…é€Ÿæ‰¾åˆ°æœ€é©åˆæ‚¨çš„å“ç®¡æ–¹æ³•
        </p>

        <div id="history-trail" class="bg-white/70 backdrop-blur-sm p-4 rounded-xl shadow-inner mb-8 min-h-[50px] flex items-center flex-wrap space-x-2 text-sm text-gray-500">
            </div>

        <div id="question-card-container" class="bg-white p-6 md:p-10 rounded-2xl shadow-2xl border-b-4 border-primary-pink/50 card-container">
            <p class="text-center text-gray-500">æ­£åœ¨è¼‰å…¥æ±ºç­–æ¨¹...</p>
        </div>

        <p class="text-center text-sm text-gray-400 mt-8">
            æ­¤ç‚ºäº’å‹•å¼æ±ºç­–æ¨¹ï¼Œé»æ“Šé¸é …å¾Œå°‡å°å‘ä¸‹ä¸€é—œæˆ–æœ€çµ‚å»ºè­°ã€‚
        </p>
    </div>

    <script>
        // --- æ±ºç­–æ¨¹è³‡æ–™çµæ§‹ (Decision Tree Content) ---
        // ä½¿ç”¨ var é¿å…åœ¨å‹•æ…‹è¼‰å…¥æ™‚ç”¢ç”Ÿé‡è¤‡å®£å‘Šçš„éŒ¯èª¤
        var decisionTree = {
            // Q1: æŒ‘æˆ°é¡å‹
            "Q1": {
                title: "é—œå¡ä¸€ï¼šæ‚¨æƒ³æŒ‘æˆ°ä»€éº¼é¡å‹çš„ä»»å‹™ï¼Ÿ",
                icon: "ğŸ¤”",
                options: [
                    { 
                        text: "ğŸ˜­ ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)ï¼šå·²ç¶“ç™¼ç”Ÿäº†éº»ç…©äº‹/å£çµæœï¼Œæˆ‘è¦è§£æ±ºå®ƒï¼", 
                        next: "Q2", 
                        color: "btn-pink" 
                    },
                    { 
                        text: "ğŸ¤© æœªä¾†ç›®æ¨™æˆ–ä»»å‹™ (èª²é¡Œé”æˆå‹)ï¼šæœªä¾†æˆ‘æƒ³é”æˆä¸€å€‹æ–°æˆå°±æˆ–æ–°æ°´æº–ï¼", 
                        next: "R_GOAL", 
                        color: "btn-purple" 
                    }
                ]
            },
            // Q2: é é˜²æˆ–è§£æ±º
            "Q2": {
                title: "é—œå¡äºŒï¼šæ‚¨çš„ç›®æ¨™æ˜¯é é˜²é‚„æ˜¯è§£æ±ºï¼Ÿ",
                icon: "ğŸ›¡ï¸",
                options: [
                    { 
                        text: "ğŸ¯ æ˜¯ï¼Œé å…ˆè©•ä¼°èˆ‡æ§åˆ¶é¢¨éšª (é é˜²é‡)ï¼šé˜»æ­¢æµç¨‹ä¸­æ½›åœ¨çš„é¢¨éšªç™¼ç”Ÿã€‚", 
                        next: "R_HFMEA", 
                        color: "btn-purple" 
                    },
                    { 
                        text: "ğŸ¤• å¦ï¼Œåˆ†æå·²ç¶“ç™¼ç”Ÿçš„å•é¡Œ (è§£æ¯’åŠ‘)ï¼šé‡å°å·²ç™¼ç”Ÿçš„å•é¡Œé€²è¡Œåˆ†æã€‚", 
                        next: "Q3", 
                        color: "btn-pink" 
                    }
                ]
            },
            // Q3: äº‹ä»¶åš´é‡æ€§
            "Q3": {
                title: "é—œå¡ä¸‰ï¼šå•é¡Œçš„åš´é‡ç¨‹åº¦èˆ‡æ·±åº¦ï¼Ÿ",
                icon: "ğŸŒ‹",
                options: [
                    { 
                        text: "ğŸš€ æ˜¯ï¼Œè¿½æŸ¥æ ¹æœ¬åŸå›  (é‡å¤§ä¸è‰¯äº‹ä»¶)ï¼šè¶…ç´šåš´é‡çš„äº‹ä»¶ï¼Œå¿…é ˆæ‰¾åˆ°ç³»çµ±æ€§çš„æœ€çµ‚åŸå› ä¸¦ä¿è­‰ä¸å†ç™¼ç”Ÿã€‚", 
                        next: "R_RCA", 
                        color: "btn-pink" 
                    },
                    { 
                        text: "ğŸ§¹ å¦ï¼Œä¸€èˆ¬æ€§ç¼ºå¤±æ”¹å–„ (æ—¥å¸¸å“è³ªæå‡)ï¼šä¸€èˆ¬æ€§çš„ç¼ºå¤±ã€æŠ±æ€¨æˆ–æ•¸æ“šä¸ä½³ã€‚", 
                        next: "R_QCC", 
                        color: "btn-purple" 
                    }
                ]
            },
            
            // --- çµæœ (Results) ---
            "R_GOAL": {
                isResult: true,
                title: "ğŸ‰ æ‚¨çš„æŒ‘æˆ°ç›®æ¨™ï¼šã€èª²é¡Œé”æˆå‹ã€‘",
                icon: "ğŸ†",
                method: "ğŸ’¡ èª²é¡Œé”æˆå‹ (Goal-Achievement)",
                purpose: "å°ˆé–€å¹«åŠ©æ‚¨å¾ã€Œç¾åœ¨ã€èµ°åˆ°ã€Œç›®æ¨™ã€ã€‚é‡é»æ˜¯ã€ç™¼æ®å‰µæ„æ‰¾æ–¹æ³•ã€‘ï¼Œé”æˆæ‚¨çš„ KPI æˆ–æŒ‘æˆ°ï¼",
                color: "goal-green"
            },
            "R_HFMEA": {
                isResult: true,
                title: "ğŸ‰ æ‚¨çš„æŒ‘æˆ°ç›®æ¨™ï¼šã€é¢¨éšªé é˜²å‹ã€‘",
                icon: "ğŸš¨",
                method: "ğŸ›¡ï¸ HFMEA (é†«ç™‚å¤±æ•ˆæ¨¡å¼èˆ‡æ•ˆæ‡‰åˆ†æ)",
                purpose: "æµç¨‹çš„ã€é è­¦é›·é”ã€‘ã€‚å®ƒèƒ½å¹«åŠ©æ‚¨åœ¨é¢¨éšªç™¼ç”Ÿå‰ï¼Œæ‰¾åˆ°æµç¨‹ä¸­æ‰€æœ‰å¯èƒ½çš„ã€Œåœ°é›·ã€ä¸¦æå‰æ§åˆ¶ï¼Œè®“æµç¨‹æ›´å®‰å…¨ï¼",
                color: "goal-green"
            },
            "R_RCA": {
                isResult: true,
                title: "ğŸ‰ æ‚¨çš„æŒ‘æˆ°ç›®æ¨™ï¼šã€æ ¹æœ¬åŸå› è¿½æŸ¥å‹ã€‘",
                icon: "ğŸ”",
                method: "ğŸ” RCA (æ ¹æœ¬åŸå› åˆ†æ)",
                purpose: "ç•¶ç™¼ç”Ÿã€é‡å¤§ä¸è‰¯äº‹ä»¶ã€‘æ™‚ï¼Œé€™å¥—å·¥å…·èƒ½æ·±å…¥æŒ–æ˜å•é¡Œçš„Root Cause (æ ¹æº)ï¼Œæ‰¾å‡ºç³»çµ±æ€§çš„æ¼æ´ï¼Œç¢ºä¿é€™é¡äº‹ä»¶ä¸æœƒå†åœ¨åŒæ¨£çš„åœ°æ–¹è·Œå€’ï¼",
                color: "issue-red"
            },
            "R_QCC": {
                isResult: true,
                title: "ğŸ‰ æ‚¨çš„æŒ‘æˆ°ç›®æ¨™ï¼šã€æ—¥å¸¸å“è³ªæ”¹å–„å‹ã€‘",
                icon: "ğŸ› ï¸",
                method: "âœ¨ QCC (å“ç®¡åœˆ) - å•é¡Œè§£æ±ºå‹",
                purpose: "æå‡æ—¥å¸¸æµç¨‹å“è³ªçš„ã€è¬ç”¨å·¥å…·ç®±ã€‘ï¼ç•¶æœ‰ç¼ºå¤±ã€æŠ±æ€¨æˆ–æ•¸æ“šä¸ä½³æ™‚ï¼Œå®ƒèƒ½å¼•å°æ‚¨ç³»çµ±åŒ–åœ°ã€Œæ‰¾åŸå›  â†’ è§£æ±ºåŸå› ã€ï¼Œè®“ç¾æ³è®Šå¾—æ›´å¥½ï¼",
                color: "goal-green"
            }
        };

        // --- æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ç®¡ç† (Logic for running the app) ---
        // è®Šæ•¸ä½¿ç”¨ var é¿å…é‡è¤‡å®£å‘ŠéŒ¯èª¤
        var currentStepKey; 
        var history; 
        var historyTrailDiv;
        var questionCardContainer;

        // ã€æ–°å¢çš„åˆå§‹åŒ–å‡½æ•¸ã€‘ç¢ºä¿æ¯æ¬¡è…³æœ¬åŸ·è¡Œæ™‚éƒ½èƒ½é‡è¨­ç‹€æ…‹ä¸¦æŠ“å– DOM å…ƒç´ 
        function initializeToolSelector() {
             // 1. é‡è¨­æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
            currentStepKey = "Q1"; 
            history = []; 
            
            // 2. é‡æ–°æŠ“å– DOM å…ƒç´ 
            historyTrailDiv = document.getElementById('history-trail');
            questionCardContainer = document.getElementById('question-card-container');
            
            // 3. è™•ç† CSS å‹•ç•«è¼‰å…¥ (ç¢ºä¿åªè¼‰å…¥ä¸€æ¬¡)
            var style = document.createElement('style');
            style.innerHTML = `
                .animate-bounce-once {
                    animation: bounce 0.8s ease-in-out 1;
                }
                @keyframes bounce {
                    0%, 100% { transform: translateY(0); }
                    20% { transform: translateY(-15px); }
                    40% { transform: translateY(0); }
                    60% { transform: translateY(-7px); }
                    80% { transform: translateY(0); }
                }
            `;
            var head = document.head || document.getElementsByTagName('head')[0];
            if (head) {
                // ç‚ºäº†é¿å…é‡è¤‡æ’å…¥ style æ¨™ç±¤ï¼Œå¯ä»¥åœ¨æ’å…¥å‰æª¢æŸ¥
                if (!document.getElementById('tool-selector-styles')) {
                     style.id = 'tool-selector-styles';
                     head.appendChild(style);
                }
            }
            
            // 4. å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼æ¸²æŸ“
            renderLadder();
        }


        // --- æ¸²æŸ“å‡½æ•¸ (Render Functions) ---

        /** æ¸²æŸ“å•é¡Œå¡ç‰‡ */
        function renderQuestion(step) {
            const currentStep = decisionTree[step];
            
            // æ¨™é¡Œ
            var html = `<div class="animate-in fade-in zoom-in duration-300">`;
            html += `<h2 class="question-title">${currentStep.icon} ${currentStep.title}</h2>`;
            html += `<p class="text-gray-500 mb-6 text-lg">è«‹æ ¹æ“šæ‚¨çš„éœ€æ±‚ï¼Œé¸æ“‡ä¸€å€‹æœ€ç¬¦åˆçš„é¸é …ï¼š</p>`;
            
            // é¸é …æŒ‰éˆ•
            html += `<div class="space-y-4">`;
            currentStep.options.forEach((option, index) => {
                const nextStep = option.next;
                // ç¢ºä¿é¸é …æ–‡å­—ä»¥ç²—é«”å‘ˆç¾
                const optionText = option.text.replace(/ã€[^ã€‘]*ã€‘/g, (match) => `<span class="font-extrabold text-shadow-sm">${match}</span>`);

                html += `<button class="btn ${option.color}" 
                                 onclick="navigate('${nextStep}', '${step}', this.textContent.trim())"
                                 data-next="${nextStep}">
                            <span class="text-xl mr-3 font-extrabold">${String.fromCharCode(65 + index)}</span> 
                            <span class="flex-grow">${optionText}</span>
                        </button>`;
            });
            html += `</div></div>`;
            
            // æª¢æŸ¥ DOM å…ƒç´ æ˜¯å¦æˆåŠŸæŠ“å–
            if(questionCardContainer) {
                 questionCardContainer.innerHTML = html;
            } else {
                 console.error("Error: questionCardContainer not found. Cannot render question.");
            }
        }

        /** æ¸²æŸ“çµæœå¡ç‰‡ */
        function renderResult(step) {
            const result = decisionTree[step];
            
            var html = `<div class="animate-in fade-in zoom-in duration-500 text-center">`;
            html += `<div class="w-24 h-24 mx-auto mb-6 bg-${result.color} rounded-full flex items-center justify-center animate-bounce-once shadow-2xl">`;
            html += `<span class="text-5xl">${result.icon}</span>`;
            html += `</div>`;
            
            html += `<h2 class="text-4xl font-extrabold text-gray-900 mb-4">${result.title}</h2>`;
            html += `<div class="inline-block p-4 rounded-xl bg-${result.color}/10 border-l-4 border-${result.color} mx-auto max-w-lg mb-6 shadow-md">`;
            html += `<h3 class="text-2xl font-bold text-gray-800 mb-2">${result.method}</h3>`;
            html += `<p class="text-gray-600 text-lg">${result.purpose}</p>`;
            html += `</div>`;
            
            // é‡ç½®æŒ‰éˆ•
            html += `<button class="btn bg-gray-500/80 text-white hover:bg-gray-700 mx-auto mt-6 w-auto px-12 py-3" 
                             onclick="navigate('Q1')">
                        ğŸ”„ é‡æ–°æŒ‘æˆ° (å¾é ­é–‹å§‹)
                    </button>`;
            html += `</div>`;
            
             // æª¢æŸ¥ DOM å…ƒç´ æ˜¯å¦æˆåŠŸæŠ“å–
            if(questionCardContainer) {
                 questionCardContainer.innerHTML = html;
            } else {
                 console.error("Error: questionCardContainer not found. Cannot render result.");
            }
        }

        /** æ¸²æŸ“æ­·å²è»Œè·¡ */
        function renderLadder() {
            var html = `<span class="font-bold text-base text-primary-pink mr-2">ğŸ—ºï¸ æ‚¨çš„é¸æ“‡è·¯å¾‘ï¼š</span>`;
            
            // æ¸²æŸ“æ­¥é©Ÿ
            history.forEach((item, index) => {
                // æ¯å€‹æ­·å²é …ç›®
                html += `
                    <div class="history-item group" onclick="rewindToStep('${item.key}')">
                        <span class="text-primary-pink font-bold">${index + 1}.</span>
                        <span class="rewind-text text-gray-600">${item.text}</span>
                        <span class="text-gray-400">Â»</span>
                    </div>
                `;
            });

            // æ¸²æŸ“ç•¶å‰ç‹€æ…‹
            const current = decisionTree[currentStepKey];
            if (current && current.isResult) {
                 html += `<span class="text-goal-green font-bold flex items-center space-x-1">${current.icon} <span>${current.method}</span></span>`;
            } else if (current) {
                 html += `<span class="text-gray-800 font-bold flex items-center space-x-1">${current.icon} <span>${current.title.split('ï¼š')[0]}</span></span>`;
            }
            
            if(historyTrailDiv) {
                historyTrailDiv.innerHTML = html;
            } else {
                console.error("Error: historyTrailDiv not found. Cannot render history.");
            }

            // æ ¹æ“šç•¶å‰æ­¥é©Ÿæ¸²æŸ“å•é¡Œæˆ–çµæœ
            if (current && current.isResult) {
                renderResult(currentStepKey);
            } else if (current) {
                renderQuestion(currentStepKey);
            }
        }


        // --- å°èˆªå‡½æ•¸ (Navigation Function) ---
        function navigate(nextState, questionKey, selectedText) {
            // å¦‚æœæ˜¯å¾å•é¡Œè·³è½‰åˆ°ä¸‹ä¸€å€‹æ­¥é©Ÿï¼Œè¨˜éŒ„æ­·å²
            if (questionKey && selectedText) {
                history.push({ key: questionKey, selection: nextState, text: selectedText });
            } else if (nextState === 'Q1') {
                // é€™æ˜¯é‡ç½®é‚è¼¯
                history = [];
            }
            currentStepKey = nextState;
            renderLadder(); 
        }

        // --- å›æº¯å‡½æ•¸ (Rewind Function) ---
        function rewindToStep(targetKey) {
            const targetIndex = history.findIndex(item => item.key === targetKey);
            if (targetIndex !== -1) {
                history = history.slice(0, targetIndex);
                navigate(targetKey);
            }
        }

        // ã€é—œéµä¿®æ­£ã€‘: è…³æœ¬ä¸€è¼‰å…¥ï¼Œå³åˆ»å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼
        initializeToolSelector();

    </script>

</body>
</html>
