<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ - å–®å¡ç‰ˆ</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ----------------------------------------------------- -->
    <!-- æ ¼å¼å€å¡Š (FORMAT BLOCK) -->
    <!-- æ‰€æœ‰å¤–è§€ã€å­—é«”å¤§å°ã€é¡è‰²ã€å‹•ç•«çš„å®šç¾©éƒ½åœ¨é€™è£¡ -->
    <!-- ----------------------------------------------------- -->
    <script>
        // Tailwind é…ç½® (é¡è‰²å®šç¾©)
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                    colors: {
                        // å¯æ„›é¢¨æ ¼çš„é…è‰²
                        'primary-pink': '#F472B6', // ä¸»è‰²èª¿ï¼šå¯æ„›ç²‰
                        'secondary-purple': '#A78BFA', // æ¬¡è¦è‰²èª¿ï¼šå¤¢å¹»ç´«
                        'goal-green': '#34D399', // é”æˆç›®æ¨™ï¼šæ¸…æ–°ç¶ 
                        'issue-red': '#F87171', // å•é¡Œè­¦ç¤ºï¼šæ´»åŠ›ç´…
                        'bg-paper': '#FFFBEB', // èƒŒæ™¯ç´™å¼µè‰²ï¼šå¥¶æ²¹é»ƒ
                    }
                }
            }
        }
    </script>
    <style>
        /* ç¢ºä¿å­—é«”åœ¨ä¸­æ–‡ç’°å¢ƒä¸‹æ­£ç¢ºé¡¯ç¤º */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #FDFCFB 0%, #E2E8F0 100%); /* æŸ”å’ŒèƒŒæ™¯æ¼¸è®Š */
        }

        /* ----------------------------------------------------- */
        /* â˜…â˜…â˜… æ±ºç­–æŒ‰éˆ•æ ¼å¼æ§åˆ¶ä¸­å¿ƒ (BUTTON FORMAT CONTROL) â˜…â˜…â˜… */
        /* ----------------------------------------------------- */
        .btn {
            /* èª¿æ•´ï¼šä½¿ç”¨æœ€å¤§æ¨™æº–å¡«å…… (px-12 py-8)ï¼Œä¸¦å°‡å­—é«”æ”¾å¤§åˆ° text-7xl (æ‰‹æ©Ÿ) / text-8xl (æ¡Œé¢) */
            @apply px-12 py-8 rounded-full font-extrabold text-7xl md:text-8xl transition duration-300 shadow-lg border-b-4 border-opacity-70;
            /* è®“æŒ‰éˆ•åœ¨å°è¢å¹•æ™‚è‡ªå‹•æ›è¡Œ */
            white-space: normal;
        }
        
        /* æŒ‰éˆ•é¡è‰²æ¨£å¼ */
        .btn-pink {
            @apply bg-primary-pink text-white border-primary-pink/80 hover:bg-pink-500 hover:border-pink-600 active:translate-y-1 active:shadow-sm;
        }
        .btn-purple {
            @apply bg-secondary-purple text-white border-secondary-purple/80 hover:bg-violet-500 hover:border-violet-600 active:translate-y-1 active:shadow-sm;
        }
        .btn-reset {
            /* é‡ç½®æŒ‰éˆ•ä½¿ç”¨è¼ƒå°çš„å­—é«”ï¼Œé¿å…éåº¦çªå‡º */
            @apply bg-gray-400 text-white border-gray-500 hover:bg-gray-500 hover:border-gray-600 active:translate-y-1 active:shadow-sm text-base;
        }
        /* ----------------------------------------------------- */
        /* â˜…â˜…â˜… æ±ºç­–æŒ‰éˆ•æ ¼å¼æ§åˆ¶ä¸­å¿ƒ çµæŸ â˜…â˜…â˜… */
        /* ----------------------------------------------------- */


        /* å®šç¾©æ±ºç­–å¡ç‰‡çš„å¯æ„›å‹•ç•«æ•ˆæœ */
        .decision-card {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.3s ease; /* Bouncy transform */
        }
        
        /* è‡ªå®šç¾©å‹•ç•« */
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-popIn {
            animation: popIn 0.5s ease-out;
        }
        
        /* è¶£å‘³å¡ç‰‡æ¨£å¼ï¼šè®“æ±ºç­–å¡ç‰‡æ›´ç«‹é«”æœ‰è¶£ */
        .fun-question-card {
            box-shadow: 10px 10px 0 0 #F472B6, 15px 15px 0 0 #A78BFA; 
            transition: all 0.2s ease-out;
        }
        .fun-question-card:hover {
            transform: translate(-2px, -2px);
            box-shadow: 12px 12px 0 0 #F472B6, 17px 17px 0 0 #A78BFA;
        }

        /* ----------------------------------------------------- */
        /* æ–°å¢ï¼šéºµåŒ…å±‘/æ­·å²ç¯€é»æ¨£å¼ */
        .breadcrumb-node {
            @apply flex items-center bg-secondary-purple text-white text-sm font-semibold px-3 py-1 rounded-full shadow-md;
        }
        .breadcrumb-node-active {
            /* ä½œç”¨æ–¼éçµæœé é¢çš„ç•¶å‰æ­¥é©Ÿ (Q1, Q2, Q3) */
            @apply bg-primary-pink text-white;
        }
        .breadcrumb-node-result {
            /* ä½œç”¨æ–¼çµæœé é¢ (R_...) */
            /* ä½¿ç”¨æ·ºç²‰è‰²èƒŒæ™¯ï¼Œæ·±è‰²æ–‡å­—ï¼Œä½¿å…¶åœ¨æ­·å²è·¯å¾‘ä¸­æ›´çªå‡ºä¸”æ˜“è®€ */
            @apply bg-primary-pink/20 text-gray-800;
        }
        /* ----------------------------------------------------- */
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- ä¸»å…§å®¹å€å¡Š -->
    <div id="app" class="w-full max-w-4xl bg-bg-paper shadow-2xl rounded-3xl p-6 md:p-12 border-4 border-primary-pink/30 animate-popIn">
        <!-- æ‡‰ç”¨ç¨‹å¼æ¨™é ­ -->
        <header class="text-center mb-8 md:mb-10">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-3 leading-tight">
                ğŸ› ï¸ å“ç®¡å·¥å…·é¸å“ªæ‹›ï¼Ÿè·Ÿæˆ‘èµ°ï¼ ğŸ’¡
            </h1>
            <p class="text-xl text-gray-500 font-medium">
                å–®å¡æ¨¡å¼ï¼Œå°ˆæ³¨ç•¶å‰å•é¡Œï¼
            </p>
        </header>

        <!-- æ­·å²ç´€éŒ„/éºµåŒ…å±‘ (æ–°çš„å±•ç¤ºå½¢å¼) -->
        <div id="history-trail" class="flex flex-wrap gap-2 mb-8 items-center justify-center min-h-[40px] border-b pb-4 border-gray-200">
            <!-- æ­·å²ç¯€é»å°‡æœƒè¢«æ¸²æŸ“åœ¨é€™è£¡ -->
        </div>
        
        <!-- ç•¶å‰å•é¡Œå¡ç‰‡å®¹å™¨ -->
        <div id="question-card-container" class="w-full">
            <!-- Loading message or initial content -->
        </div>

        <div id="reset-button-container" class="mt-8 pt-4 border-t border-gray-200 text-center">
            <button class="btn btn-reset px-6 py-3" onclick="navigate('Q1')">
                ğŸ”„ é‡ç½®æŒ‘æˆ°
            </button>
        </div>
    </div>

    <!-- ----------------------------------------------------- -->
    <!-- å…§å®¹å€å¡Š (CONTENT BLOCK) -->
    <!-- ----------------------------------------------------- -->
    <script>
        // --- æ±ºç­–æ¨¹è³‡æ–™çµæ§‹ (Decision Tree Content) ---
        const decisionTree = {
            Q1: { 
                title: "ğŸ¾ é—œå¡ä¸€ï¼šæŒ‘æˆ°é¡å‹", 
                question: "æ‚¨æƒ³è™•ç†çš„æ˜¯ã€Œã€å·²ç¶“ç™¼ç”Ÿã€‘çš„éº»ç…©äº‹/å£çµæœã€ (å•é¡Œå‹)ï¼Ÿé‚„æ˜¯ã€æœªä¾†æƒ³é”æˆã€‘çš„æ–°æˆå°±/å¥½æ°´æº– (èª²é¡Œå‹)ï¼Ÿ", 
                icon: "ğŸ¤”", 
                options: [
                    { text: "ğŸ˜­ ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)", next: "Q2", style: "btn-pink" },
                    { text: "ğŸ¤© æœªä¾†ç›®æ¨™æˆ–ä»»å‹™ (èª²é¡Œé”æˆå‹)", next: "R_GOAL", style: "btn-purple" }
                ]
            },
            Q2: { 
                title: "ğŸš¨ é—œå¡äºŒï¼šé é˜²æˆ–è§£æ±º", 
                question: "æ‚¨çš„ç›®æ¨™æ˜¯ã€Œã€é å…ˆã€‘é˜»æ­¢æµç¨‹ä¸­ã€æ½›åœ¨ã€‘çš„é¢¨éšªç™¼ç”Ÿã€å—ï¼Ÿ (åƒæ‰“é é˜²é‡ä¸€æ¨£)", 
                icon: "ğŸ›¡ï¸", 
                options: [
                    { text: "ğŸ¯ æ˜¯ï¼Œé å…ˆè©•ä¼°èˆ‡æ§åˆ¶é¢¨éšª (é é˜²é‡)", next: "R_HFMEA", style: "btn-purple" },
                    { text: "ğŸ¤• å¦ï¼Œåˆ†æå·²ç¶“ç™¼ç”Ÿçš„å•é¡Œ (è§£æ¯’åŠ‘)", next: "Q3", style: "btn-pink" }
                ]
            },
            Q3: { 
                title: "ğŸ’¥ é—œå¡ä¸‰ï¼šäº‹ä»¶åš´é‡æ€§", 
                question: "é€™å€‹å•é¡Œæ˜¯ã€Œã€è¶…ç´šåš´é‡ã€‘çš„é‡å¤§/ä¸è‰¯äº‹ä»¶ã€ï¼Œæ‚¨éœ€è¦æ‰¾å‡ºã€ç³»çµ±æ€§çš„æœ€çµ‚åŸå› ã€‘ä¸¦ã€ä¿è­‰ä¸å†ç™¼ç”Ÿã€‘å—ï¼Ÿ", 
                icon: "ğŸ”", 
                options: [
                    { text: "ğŸš€ æ˜¯ï¼Œè¿½æŸ¥æ ¹æœ¬åŸå›  (é‡å¤§ä¸è‰¯äº‹ä»¶)", next: "R_RCA", style: "btn-purple" },
                    { text: "ğŸ§¹ å¦ï¼Œä¸€èˆ¬æ€§ç¼ºå¤±æ”¹å–„ (æ—¥å¸¸å“è³ªæå‡)", next: "R_QCC", style: "btn-pink" }
                ]
            },
            
            // --- çµæœé é¢ (Results) ---
            R_GOAL: { title: "ğŸ‰ æ­å–œï¼æ‚¨æ‰¾åˆ°äº†æˆåŠŸé‘°åŒ™ï¼", methodology: "ğŸ’¡ èª²é¡Œé”æˆå‹ (Goal-Achievement)", purpose: "é€™æ–¹æ³•å°ˆé–€å¹«åŠ©æ‚¨å¾ã€Œç¾åœ¨ã€èµ°åˆ°ã€Œç›®æ¨™ã€ã€‚é‡é»æ˜¯ã€ç™¼æ®å‰µæ„æ‰¾æ–¹æ³•ã€‘ï¼Œé”æˆæ‚¨çš„ KPI æˆ–æŒ‘æˆ°ï¼", icon: "ğŸ†", bgColor: "bg-goal-green/15", textColor: "text-goal-green", borderColor: "border-goal-green" },
            R_HFMEA: { title: "ğŸ’– é¢¨éšªé˜²è­·ç½©å·²å•Ÿå‹•ï¼", methodology: "ğŸ›¡ï¸ HFMEA (é†«ç™‚å¤±æ•ˆæ¨¡å¼èˆ‡æ•ˆæ‡‰åˆ†æ)", purpose: "é€™å°±åƒæ˜¯æµç¨‹çš„ã€é è­¦é›·é”ã€‘ã€‚å®ƒèƒ½å¹«åŠ©æ‚¨åœ¨é¢¨éšªç™¼ç”Ÿå‰ï¼Œæ‰¾åˆ°æµç¨‹ä¸­æ‰€æœ‰å¯èƒ½çš„ã€Œåœ°é›·ã€ä¸¦æå‰æ§åˆ¶ï¼Œè®“æµç¨‹æ›´å®‰å…¨ï¼", icon: "ğŸš¨", bgColor: "bg-secondary-purple/15", textColor: "text-secondary-purple", borderColor: "border-secondary-purple" },
            R_RCA: { title: "ğŸ•µï¸â€â™‚ï¸ ç³»çµ±åµæ¢å‡ºå‹•ï¼", methodology: "ğŸ” RCA (æ ¹æœ¬åŸå› åˆ†æ)", purpose: "ç•¶ç™¼ç”Ÿã€é‡å¤§ä¸è‰¯äº‹ä»¶ã€‘æ™‚ï¼Œæ‚¨éœ€è¦é€™å¥—å·¥å…·æ·±å…¥æŒ–æ˜å•é¡Œçš„Root Cause (æ ¹æº)ã€‚å®ƒæœƒæ‰¾å‡ºç³»çµ±æ€§çš„æ¼æ´ï¼Œç¢ºä¿é€™é¡äº‹ä»¶ä¸æœƒå†åœ¨åŒæ¨£çš„åœ°æ–¹è·Œå€’ï¼", icon: "ğŸ¤¯", bgColor: "bg-issue-red/15", textColor: "text-issue-red", borderColor: "border-issue-red" },
            R_QCC: { title: "ğŸ› ï¸ æ—¥å¸¸å„ªåŒ–å°ˆå®¶å°±æ˜¯æ‚¨ï¼", methodology: "âœ¨ QCC (å•é¡Œè§£æ±ºå‹/å“è³ªæ”¹å–„)", purpose: "é€™æ˜¯æ‚¨æå‡æ—¥å¸¸æµç¨‹å“è³ªçš„ã€è¬ç”¨å·¥å…·ç®±ã€‘ï¼ç•¶æœ‰ç¼ºå¤±ã€æŠ±æ€¨æˆ–æ•¸æ“šä¸ä½³æ™‚ï¼Œå®ƒèƒ½å¼•å°æ‚¨ç³»çµ±åŒ–åœ°ã€Œæ‰¾åŸå›  â†’ è§£æ±ºåŸå› ã€ï¼Œè®“ç¾æ³è®Šå¾—æ›´å¥½ï¼", icon: "ğŸŒˆ", bgColor: "bg-primary-pink/15", textColor: "text-primary-pink", borderColor: "border-primary-pink" }
        };
        // --- æ±ºç­–æ¨¹è³‡æ–™çµæ§‹ (Decision Tree Content) çµæŸ ---


        // --- æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ç®¡ç† (Logic for running the app) ---
        let currentStepKey = "Q1";
        // Tracks the path taken: [{key: "Q1", selection: "Q2", text: "ç¾æœ‰ç¼ºå¤±æˆ–ç•°å¸¸ (å•é¡Œè§£æ±ºå‹)"}, ...]
        let history = []; 
        const historyTrailDiv = document.getElementById('history-trail'); // æ–°çš„æ­·å²ç´€éŒ„å®¹å™¨
        const questionCardContainer = document.getElementById('question-card-container'); // æ–°çš„ç•¶å‰å•é¡Œå®¹å™¨

        // --- æ¸²æŸ“å·¥å…·å‡½æ•¸ (Rendering Helpers) ---
        
        /** å–å¾—æ­¥é©Ÿçš„ç°¡çŸ­æ¨™é¡Œ */
        function getStepTitle(key) {
            if (key === 'Q1') return "æŒ‘æˆ°é¡å‹";
            if (key === 'Q2') return "é é˜²æˆ–è§£æ±º";
            if (key === 'Q3') return "äº‹ä»¶åš´é‡æ€§";
            return "æœ€çµ‚çµæœ";
        }

        /** æ¸²æŸ“ä¸€å€‹å·²å®Œæˆçš„æ­¥é©Ÿç¯€é» (æ°´å¹³éºµåŒ…å±‘æ¨£å¼) */
        function renderCompletedNode(item, index) {
            const stepTitle = getStepTitle(item.key);
            const stepNumber = index + 1; // å¾ 1 é–‹å§‹ç·¨è™Ÿ

            const nodeHtml = `
                <div class="flex items-center">
                    <!-- ç¯€é»æ¨™é¡Œå’Œé¸æ“‡ -->
                    <button class="breadcrumb-node group" onclick="rewindToStep('${item.key}')" title="é»æ“Šå›åˆ°æ­¤æ­¥é©Ÿ">
                        <span class="mr-2 opacity-80 group-hover:opacity-100">${stepNumber}. ${stepTitle}</span>
                        <!-- ç°¡çŸ­çš„é¸æ“‡å…§å®¹ -->
                        <span class="font-normal text-xs opacity-70 group-hover:opacity-90">(${item.text.split(' ')[0]})</span>
                    </button>
                    <!-- åˆ†éš”ç¬¦è™Ÿ -->
                    <span class="text-secondary-purple mx-1.5 md:mx-2 text-2xl font-bold">Â»</span>
                </div>
            `;
            return nodeHtml;
        }

        /** æ¸²æŸ“ç›®å‰æ­£åœ¨äº’å‹•çš„å•ç­”å¡ç‰‡ */
        function renderCurrentQuestion(step, stepKey) {
            const stepNumber = stepKey.replace('Q', '');
            
            // å®šç¾©æ¯å€‹æŒ‰éˆ•æ¨£å¼å°æ‡‰çš„åº•è‰²å’Œé‚Šæ¡†
            const bgColors = {
                'btn-pink': 'bg-primary-pink/10 border-primary-pink/30', // ç²‰è‰²æŒ‰éˆ•é…æ·ºç²‰è‰²åº•
                'btn-purple': 'bg-secondary-purple/10 border-secondary-purple/30', // ç´«è‰²æŒ‰éˆ•é…æ·ºç´«è‰²åº•
            };
            
            return `
                <div class="bg-white p-8 md:p-12 rounded-3xl shadow-2xl border-4 border-primary-pink/50 w-full decision-card animate-popIn fun-question-card">
                    
                    <div class="text-center mb-8">
                        <span class="text-6xl mb-4 block">${step.icon}</span>
                        <!-- ç¢ºä¿æ¨™é¡Œå­—é«”å¤§å°è¶³å¤  -->
                        <h2 class="text-2xl md:text-4xl font-extrabold text-gray-800">${stepNumber}. ${step.title}</h2>
                    </div>

                    <!-- å•é¡Œæè¿°æ–‡å­— (èª¿æ•´ç‚º text-2xl) -->
                    <div class="text-2xl text-gray-700 mb-10 p-6 md:p-8 bg-pink-50 border-4 border-primary-pink rounded-2xl shadow-inner font-medium leading-relaxed text-center">
                        ${step.question}
                    </div>
                    
                    <!-- é¸é …æŒ‰éˆ•å®¹å™¨ (æ¯å€‹é¸é …ä½œç‚ºä¸€å€‹ç¨ç«‹çš„å¡ç‰‡) -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                        ${step.options.map(option => `
                            <!-- å–®å€‹é¸é …å¡ç‰‡åŒ…è£ (ç¨ç«‹åº•è‰²) -->
                            <div class="p-5 rounded-2xl shadow-xl border-4 ${bgColors[option.style] || 'bg-gray-100 border-gray-300'} hover:shadow-2xl transition duration-300 transform hover:-translate-y-0.5">
                                <button 
                                    class="btn w-full ${option.style}" 
                                    onclick="navigate('${option.next}', '${stepKey}', '${option.text}')"
                                >
                                    ${option.text}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        /** æ¸²æŸ“æœ€çµ‚çµæœå¡ç‰‡ */
        function renderFinalResult(result) {
            return `
                <div class="${result.bgColor} p-6 md:p-12 rounded-3xl shadow-2xl border-t-8 ${result.borderColor} w-full decision-card animate-popIn">

                    <div class="text-center mb-6">
                        <span class="text-8xl mb-4 block animate-bounce-once">${result.icon}</span>
                        <!-- åŠ å¤§çµæœæ¨™é¡Œå­—é«” -->
                        <h2 class="text-4xl md:text-5xl font-extrabold ${result.textColor} mb-4">${result.title}</h2>
                        
                        <!-- å¼·èª¿æœ€çµ‚å»ºè­°çš„å·¥å…· -->
                        <div class="inline-block bg-white/70 p-4 rounded-xl border-4 border-dashed ${result.borderColor} shadow-lg">
                           <p class="text-2xl md:text-4xl font-extrabold text-gray-800">
                                âœ… å»ºè­°æ‚¨æ¡ç”¨ï¼š${result.methodology}
                            </p>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-xl border-2 ${result.borderColor}/50 shadow-inner mb-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-3 border-b-2 pb-2">ğŸ¯ ç›®çš„èˆ‡é‡é»æ‘˜è¦</h3>
                        <!-- åŠ å¤§ç›®çš„æè¿°å­—é«” -->
                        <p class="text-xl text-gray-600 leading-relaxed">${result.purpose}</p>
                    </div>

                    <p class="text-base text-center text-gray-500 mb-4 font-semibold">
                        æ­å–œæ‚¨å®Œæˆè©•ä¼°ï¼
                    </p>
                    
                    <!-- å‰å¾€æ­¥é©ŸæŒ‰éˆ• (ä½¿ç”¨æ–°çš„æŒ‰éˆ•æ¨£å¼ä½†è¼ƒå°) -->
                    <div class="text-center space-y-4">
                        <button class="bg-primary-pink text-white border-b-4 border-pink-700 hover:bg-pink-600 active:translate-y-1 active:shadow-sm text-lg font-bold px-8 py-3 rounded-full shadow-md transition duration-300 w-full md:w-auto"
                            onclick="console.log('--- æ¨¡æ“¬é€£çµåˆ°å¯¦æ–½æ­¥é©Ÿ ---');">
                            â–¶ï¸ å‰å¾€ã€${result.methodology}ã€‘è©³ç´°å¯¦æ–½æ­¥é©Ÿ
                        </button>
                    </div>
                    <!-- --------------------- -->
                </div>
            `;
        }

        // --- ä¸»æ¸²æŸ“å‡½æ•¸ (Main Render Function) ---
        function renderLadder() {
            // 1. æ¸²æŸ“æ­·å²ç´€éŒ„ (éºµåŒ…å±‘)
            const historyHtml = history.map(renderCompletedNode).join('');
            
            // åŠ å…¥ç•¶å‰æ­¥é©Ÿçš„æ¨™è¨˜ (å·²æ ¹æ“šæ˜¯å¦ç‚ºçµæœé€²è¡Œä¿®æ­£)
            const isResult = currentStepKey.startsWith('R_');
            let currentStepText;
            let currentStepClasses; // æ–°å¢è®Šé‡ä¾†æ§åˆ¶é¡è‰²

            if (isResult) {
                // å¦‚æœæ˜¯çµæœï¼Œé¡¯ç¤ºæœ€çµ‚æ¨è–¦çš„å·¥å…·åç¨±
                const resultData = decisionTree[currentStepKey];
                currentStepText = `æœ€çµ‚æ¨è–¦ï¼š${resultData.methodology}`;
                // æ‡‰ç”¨æ–°çš„æ¨£å¼ï¼šæ·ºç²‰è‰²èƒŒæ™¯ + æ·±ç°æ–‡å­—
                currentStepClasses = 'breadcrumb-node-result'; 
            } else {
                // å¦‚æœæ˜¯å•é¡Œï¼Œé¡¯ç¤ºé—œå¡åç¨±å’Œé€²è¡Œä¸­
                const currentStepTitle = getStepTitle(currentStepKey);
                currentStepText = `${history.length + 1}. ${currentStepTitle} (é€²è¡Œä¸­)`;
                // æ‡‰ç”¨åŸæœ¬çš„æ´»å‹•æ¨£å¼ï¼šæ·±ç²‰è‰²èƒŒæ™¯ + ç™½è‰²æ–‡å­—
                currentStepClasses = 'breadcrumb-node-active';
            }
            
            const currentStepHtml = `
                <div class="flex items-center">
                    <span class="breadcrumb-node ${currentStepClasses}">
                        ${currentStepText}
                    </span>
                </div>
            `;
            
            historyTrailDiv.innerHTML = historyHtml + currentStepHtml;


            // 2. æ¸²æŸ“ç•¶å‰å•é¡Œæˆ–çµæœå¡ç‰‡
            questionCardContainer.innerHTML = '';
            const stepData = decisionTree[currentStepKey];
            let cardHtml = '';

            if (currentStepKey.startsWith('R_')) {
                cardHtml = renderFinalResult(stepData);
            } else if (stepData) {
                cardHtml = renderCurrentQuestion(stepData, currentStepKey);
            } else {
                cardHtml = `<div class="text-red-500 text-center p-10">éŒ¯èª¤ï¼šæ‰¾ä¸åˆ°æ­¥é©Ÿ ${currentStepKey}</div>`;
            }
            
            questionCardContainer.innerHTML = cardHtml;

            // ç¢ºä¿é é¢æ»¾å‹•åˆ°æœ€ä¸Šæ–¹
            document.getElementById('app').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- å°èˆªå‡½æ•¸ (Navigation Function) ---
        function navigate(nextState, questionKey, selectedText) {
            // å¦‚æœæœ‰å‰ä¸€å€‹æ­¥é©Ÿè³‡è¨Šï¼Œå‰‡è¨˜éŒ„åœ¨æ­·å²ä¸­
            if (questionKey && decisionTree[questionKey]) {
                history.push({ key: questionKey, selection: nextState, text: selectedText });
            } else if (nextState === 'Q1') {
                // é€™æ˜¯é‡ç½®é‚è¼¯
                history = [];
            }
            currentStepKey = nextState;
            renderLadder();
        }

        // --- å›æº¯å‡½æ•¸ (Rewind Function) ---
        function rewindToStep(targetKey) {
            // æ‰¾åˆ°ç›®æ¨™æ­¥é©Ÿåœ¨æ­·å²ä¸­çš„ç´¢å¼•
            const targetIndex = history.findIndex(item => item.key === targetKey);
            if (targetIndex !== -1) {
                // æˆªæ–·æ­·å²ï¼Œåªä¿ç•™åˆ°ç›®æ¨™æ­¥é©Ÿä¹‹å‰çš„éƒ¨åˆ†
                history = history.slice(0, targetIndex);
                // å°èˆªåˆ°ç›®æ¨™æ­¥é©Ÿ
                navigate(targetKey);
            }
        }

        // æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•æ™‚ï¼Œå°èˆªåˆ°ç¬¬ä¸€å€‹å•é¡Œ
        // ä½¿ç”¨ IIFE (ç«‹å³åŸ·è¡Œå‡½æ•¸) ç¢ºä¿åœ¨é é¢çµæ§‹è¼‰å…¥å¾Œç«‹å³å•Ÿå‹•æ¸²æŸ“ï¼Œè€Œä¸æ˜¯ç­‰å¾… window.onload
        (function init() {
             // å®šç¾©è®“çµæœåœ–ç¤ºå½ˆè·³ä¸€æ¬¡çš„ CSS å‹•ç•«
            const style = document.createElement('style');
            style.innerHTML += `
                .animate-bounce-once {
                    animation: bounce 0.8s ease-in-out 1;
                }
                @keyframes bounce {
                    0%, 100% { transform: translateY(0); }
                    20% { transform: translateY(-15px); }
                    40% { transform: translateY(0); }
                    60% { transform: translateY(-7px); }
                    80% { transform: translateY(0); }
                }
            `;
            document.head.appendChild(style);
            
            navigate('Q1'); // ç«‹å³æ¸²æŸ“ç¬¬ä¸€å€‹æ­¥é©Ÿ
        })();
    </script>

</body>
</html>
