<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“ç®¡åœˆï¼ˆQCCï¼‰æ–°æ‰‹å…¥é–€äº’å‹•æŒ‡å—</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è¨­ç½®å­—é«”ç‚º Inter -->
    <style>
        /* ä½¿ç”¨ Inter å­—é«” */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ecfdf5; /* è¼•ç›ˆçš„æ·ºç¶ èƒŒæ™¯ */
        }
        /* å€å¡Šæ¨™é¡Œæ¨£å¼ */
        .section-title {
            border-left: 6px solid #0d9488; /* æ·±é’è‰²å´é‚Šè£é£¾ */
            padding-left: 0.75rem;
            transition: all 0.3s ease-in-out;
        }
        /* Tab/Nav æŒ‰éˆ•æ¨£å¼ */
        .nav-button {
            transition: all 0.3s ease-in-out;
            border-bottom: 3px solid transparent;
        }
        .nav-button.active {
            color: #0d9488; /* æ·±é’è‰²æ–‡å­— */
            border-color: #0d9488; /* æ·±é’è‰²åº•ç·š */
            font-weight: 700;
        }
        .ai-chat-response {
            white-space: pre-wrap; /* ä¿æŒæ›è¡Œå’Œç©ºæ ¼ */
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0d9488; /* æ­é…ä¸»é¡Œè‰² */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* --- æ–°å¢ï¼šå›åˆ°é ‚ç«¯æŒ‰éˆ•æ¨£å¼ --- */
        #backToTopBtn {
            /* å›ºå®šä½ç½®ï¼Œé å³ä¸‹æ–¹ */
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
            /* éš±è—ä½†æº–å‚™å¥½æ·¡å…¥ */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            cursor: pointer;
            width: 3rem;
            height: 3rem;
        }
        /* æŒ‰éˆ•é¡¯ç¤ºæ™‚çš„æ¨£å¼ */
        #backToTopBtn.show {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="antialiased">

    <!-- ä¸»è¦å®¹å™¨ -->
    <div class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- æ¨™é¡Œå€å¡Š -->
        <header id="header" class="text-center py-10 bg-white shadow-xl rounded-xl mb-6 border-t-8 border-teal-600">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-2">å“ç®¡åœˆï¼ˆQCCï¼‰æ–°æ‰‹å…¥é–€äº’å‹•æŒ‡å—</h1>
            <p class="text-xl text-gray-500">å¾æ¦‚å¿µåˆ°å¯¦è¸ï¼Œå“è³ªæ”¹å–„çš„æ—…ç¨‹ç”±æ­¤é–‹å§‹ï¼</p>
        </header>

        <!-- å°èˆªæŒ‰éˆ• (Scroll Nav + iframe åˆ‡æ›) -->
        <nav class="sticky top-0 z-10 flex justify-center bg-white p-2 rounded-xl shadow-lg mb-8 space-x-4">
            <!-- é¦–é æŒ‰éˆ•ï¼šå›åˆ°é é¢é ‚éƒ¨ -->
            <button id="nav-btn-home" onclick="scrollToSection('header', 'nav-btn-home')" class="nav-button active text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                ğŸš€ é¦–é  (æ´»å‹•ç¸½è¦½)
            </button>

            <!-- æ›¸é¢æ ¼å¼æŒ‰éˆ•ï¼šåœ¨ iframe ä¸­è¼‰å…¥å­é  -->
            <button id="nav-btn-form"
                    onclick="loadPage('æ›¸é¢æ ¼å¼_å•é¡Œå‹.html')"
                    class="nav-button text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                ğŸ“ æ›¸é¢æ ¼å¼ (QC Story)
            </button>

            <!-- åƒè€ƒè³‡æ–™æŒ‰éˆ•ï¼šè·³è½‰åˆ° QC å·¥å…·å€å¡Š -->
            <button id="nav-btn-tools" onclick="scrollToSection('qc-tools', 'nav-btn-tools')" class="nav-button text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                ğŸ› ï¸ åƒè€ƒè³‡æ–™ (å“ç®¡å·¥å…·)
            </button>
        </nav>

        <!-- iframe é¡¯ç¤ºå€ï¼šè¼‰å…¥å…¶ä»–é é¢ç”¨ -->
        <div class="w-full h-[85vh] border rounded-lg overflow-hidden shadow mb-10">
            <iframe id="content-frame" src="" class="w-full h-full" frameborder="0"></iframe>
        </div>
        
        <!-- å…§å®¹å€å¡Š (é›†ä¸­åœ¨é¦–é ï¼Œé€éæ»¾å‹•å‘ˆç¾) -->
        <main id="main-content" class="space-y-12">

            <!-- å€å¡Š A: ä»€éº¼æ˜¯å“ç®¡åœˆï¼ˆQCCï¼‰ï¼Ÿ (ä½œç‚ºé¦–é ä¸»è¦å…§å®¹) -->
            <section id="what-is-qcc" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-teal-500 hover:shadow-2xl transition duration-300">
                <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="ä»€éº¼æ˜¯å“ç®¡åœˆï¼ˆQCCï¼‰ï¼Ÿ">1. ä»€éº¼æ˜¯å“ç®¡åœˆï¼ˆQCCï¼‰ï¼Ÿ</h2>
                <div class="text-gray-600 leading-relaxed space-y-4">
                    <p>å“ç®¡åœˆï¼ˆQuality Control Circle, QCCï¼‰æ˜¯ä¸€ç¨®æŒçºŒæ”¹å–„æ´»å‹•ï¼Œé¼“å‹µ<strong class="font-semibold text-teal-600">åŸºå±¤åŒä»</strong>çµ„æˆå°çµ„ï¼Œå…±åŒé‹ç”¨å„ç¨®å“ç®¡å·¥å…·å’Œæ‰‹æ³•ï¼Œä»¥ç³»çµ±æ€§çš„æ­¥é©Ÿè§£æ±ºå·¥ä½œç¾å ´çš„å•é¡Œï¼Œæˆ–é”æˆç‰¹å®šçš„æ”¹å–„ç›®æ¨™ã€‚</p>
                    <p>å®ƒä¸åƒ…æ˜¯ä¸€ç¨®ç®¡ç†å·¥å…·ï¼Œæ›´æ˜¯ä¸€ç¨®<strong class="font-semibold text-teal-600">å“è³ªæ–‡åŒ–</strong>çš„é¤Šæˆéç¨‹ã€‚é€éé€™æ¨£çš„æ´»å‹•ï¼Œèƒ½åŸ¹é¤ŠåŒä»çš„å“ç®¡æ„è­˜ã€åœ˜éšŠåˆä½œèƒ½åŠ›ï¼Œé€²è€ŒæŒçºŒä¸æ–·åœ°æå‡æœå‹™å“è³ªèˆ‡å·¥ä½œæ•ˆç‡ã€‚</p>
                </div>
                <!-- AI è¼”åŠ©æå•å€å¡Š -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <h4 class="font-semibold text-lg text-gray-700 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 13a2 2 0 012-2h10a2 2 0 012 2v1a2 2 0 01-2 2H7a2 2 0 01-2-2v-1z"></path></svg>
                        AI è¼”åŠ©æå•ï¼šæƒ³å•é»é—œæ–¼æœ¬ç¯€å…§å®¹å—ï¼Ÿ
                    </h4>
                    <div id="chat-what-is-qcc">
                        <!-- Chat UI will be initialized here -->
                    </div>
                </div>
            </section>
            
            <!-- å€å¡Š B: é‹ç”¨åˆé©çš„å“ç®¡å·¥å…·è§£æ±ºå•é¡Œï¼ˆäº”å¤§æ”¹å–„é¡å‹ï¼‰ -->
            <section id="tool-selection" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-teal-500 hover:shadow-2xl transition duration-300">
                <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="é‹ç”¨åˆé©çš„å“ç®¡å·¥å…·è§£æ±ºå•é¡Œï¼ˆäº”å¤§æ”¹å–„é¡å‹ï¼‰">2. é‹ç”¨åˆé©çš„å“ç®¡å·¥å…·è§£æ±ºå•é¡Œï¼ˆäº”å¤§æ”¹å–„é¡å‹ï¼‰</h2>
                <p class="text-gray-600 mb-6">å“è³ªæ”¹å–„æ´»å‹•æ‡‰ä¾æ“šå•é¡Œçš„æ€§è³ªã€ç™¼ç”Ÿæ™‚æ©Ÿèˆ‡ç›®æ¨™ï¼Œé¸æ“‡æœ€åˆé©çš„æ‰‹æ³•å’Œå·¥å…·ï¼Œä»¥é”åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚</p>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- é¡å‹ 1: å•é¡Œè§£æ±ºå‹ -->
                    <div class="border-t-4 border-red-500 bg-red-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                        <h3 class="font-bold text-xl text-red-700 mb-2">1. å•é¡Œè§£æ±ºå‹ï¼ˆå›æº¯ï¼‰</h3>
                        <p class="text-sm font-semibold text-red-600 mb-2">è™•ç†å·²ç™¼ç”Ÿçš„è² é¢è½å·®ã€‚</p>
                        <p class="text-sm text-gray-600">
                            é©ç”¨æ–¼<strong class="font-semibold">ã€Œç¾ç‹€èˆ‡æ‡‰æœ‰ç‹€æ…‹ã€ä¹‹é–“å­˜åœ¨è² é¢è½å·®</strong>çš„æƒ…æ³ã€‚ç›®æ¨™æ˜¯è§£æ±ºå·²ç¶“ç™¼ç”Ÿçš„å•é¡Œï¼Œæ¶ˆé™¤ä¸è‰¯ã€éŒ¯èª¤æˆ–ä½æ•ˆç‡ã€‚
                        </p>
                    </div>
                    <!-- é¡å‹ 2: èª²é¡Œé”æˆå‹ -->
                    <div class="border-t-4 border-blue-500 bg-blue-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                        <h3 class="font-bold text-xl text-blue-700 mb-2">2. èª²é¡Œé”æˆå‹ï¼ˆå‰µæ–°å‹ï¼‰</h3>
                        <p class="text-sm font-semibold text-blue-600 mb-2">è™•ç†ç¾ç‹€èˆ‡ç†æƒ³ç‹€æ…‹çš„æ­£é¢å·®è·ã€‚</p>
                        <p class="text-sm text-gray-600">ç›®æ¨™æ˜¯é”æˆæ›´é«˜å±¤æ¬¡çš„æŒ‘æˆ°æ€§ç›®æ¨™ï¼Œé€²è¡Œå‰µæ–°æˆ–çªç ´ç¾ç‹€ã€‚</p>
                    </div>
                    <!-- é¡å‹ 3: é å…ˆé˜²ç¯„å‹ -->
                    <div class="border-t-4 border-green-500 bg-green-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                        <h3 class="font-bold text-xl text-green-700 mb-2">3. é å…ˆé˜²ç¯„å‹ï¼ˆä¸»å‹•é é˜²ï¼‰</h3>
                        <p class="text-sm font-semibold text-green-600 mb-2">é æ¸¬ä¸¦æ¶ˆé™¤æ½›åœ¨çš„å¤±æ•—æ¨¡å¼ (å¦‚ HFMEA)ã€‚</p>
                        <p class="text-sm text-gray-600">ç³»çµ±æ€§åœ°åˆ†æ<strong class="font-semibold">æ–°æµç¨‹æˆ–é«˜é¢¨éšªæµç¨‹</strong>ä¸­æ‰€æœ‰æ½›åœ¨çš„å¤±æ•—æ¨¡å¼ã€‚</p>
                    </div>
                    <!-- é¡å‹ 4: å›æº¯å‹ -->
                    <div class="border-t-4 border-purple-500 bg-purple-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                        <h3 class="font-bold text-xl text-purple-700 mb-2">4. å›æº¯å‹ï¼ˆåš´é‡äº‹ä»¶åˆ†æï¼‰</h3>
                        <p class="text-sm font-semibold text-purple-600 mb-2">é‡å°å·²ç™¼ç”Ÿåš´é‡äº‹ä»¶è¿½æº¯åŸå›  (å¦‚ RCA)ã€‚</p>
                        <p class="text-sm text-gray-600">é‡å°<strong class="font-semibold">å·²ç™¼ç”Ÿæˆ–è¿‘ä¹ç™¼ç”Ÿçš„åš´é‡äº‹ä»¶</strong>é€²è¡Œæ·±å…¥ã€ç³»çµ±æ€§çš„åˆ†æã€‚</p>
                    </div>
                    <!-- é¡å‹ 5: æµç¨‹åˆ†æèˆ‡æ”¹é€  -->
                    <div class="border-t-4 border-yellow-500 bg-yellow-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                        <h3 class="font-bold text-xl text-yellow-700 mb-2">5. æµç¨‹å„ªåŒ–èˆ‡æ”¹é€ ï¼ˆæ•ˆç‡ï¼‰</h3>
                        <p class="text-sm font-semibold text-yellow-600 mb-2">è‘—é‡æ–¼æ•ˆç‡ã€æˆæœ¬æˆ–å‹•ç·šçš„æ”¹å–„ (IE æ€ç¶­)ã€‚</p>
                        <p class="text-sm text-gray-600">å°ç¾æœ‰ä½œæ¥­æµç¨‹é€²è¡Œè¨ºæ–·ï¼Œæ‰¾å‡º<strong class="font-semibold">æµç¨‹ä¸­çš„æµªè²»ã€ç“¶é ¸</strong>ã€‚</p>
                    </div>
                </div>
                <!-- AI è¼”åŠ©æå•å€å¡Š -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <h4 class="font-semibold text-lg text-gray-700 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2m-3 10h.01M9 19v2m6-2v2M5 13a2 2 0 012-2h10a2 2 0 012 2v1a2 2 0 01-2 2H7a2 2 0 01-2-2v-1z"></path></svg>
                        AI è¼”åŠ©æå•ï¼šæƒ³å•é»é—œæ–¼æœ¬ç¯€å…§å®¹å—ï¼Ÿ
                    </h4>
                    <div id="chat-tool-selection">
                        <!-- Chat UI will be initialized here -->
                    </div>
                </div>
            </section>
            
            <!-- å€å¡Š C: æ›¸é¢æ ¼å¼ (Document Format) - å°ˆæ³¨æ–¼æ­¥é©Ÿèˆ‡æ–‡ä»¶æ’°å¯« -->
            <section id="qcc-steps" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-fuchsia-500 mt-12">
                <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="å“ç®¡æ”¹å–„æ­¥é©Ÿèˆ‡æ›¸é¢æ ¼å¼é‡é»">ğŸ“ å“ç®¡æ”¹å–„æ­¥é©Ÿèˆ‡æ›¸é¢æ ¼å¼é‡é» (QC Story)</h2>
                <p class="text-gray-600 mb-6">å•é¡Œè§£æ±ºå‹å“ç®¡åœˆé€šå¸¸éµå¾ªä»¥ä¸‹åå€‹æ¨™æº–æ­¥é©Ÿï¼Œé€™ä¹Ÿæ˜¯æ‚¨æ’°å¯«å ±å‘Šæ™‚çš„éª¨å¹¹çµæ§‹ã€‚</p>
                
                <!-- QCC æ­¥é©Ÿè¡¨æ ¼ -->
                <div class="overflow-x-auto rounded-lg shadow-md border-2 border-fuchsia-100">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-fuchsia-50">
                            <tr>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-1/12">No.</th>
                                <th scope="col" class="px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-3/12">æ­¥é©Ÿåç¨±</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-5/12">æ›¸é¢å ±å‘Šé‡é» (What to Write)</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-3/12">é—œéµå·¥å…·</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">1</td>
                                <td class="px-3 py-4 whitespace-nowrap">çµ„åœˆèˆ‡ä¸»é¡Œé¸å®š</td>
                                <td class="px-6 py-4">èªªæ˜åœ˜éšŠæˆå“¡ã€åœˆåã€é¸å®šä¸»é¡Œçš„ç†ç”±ï¼ˆæ€¥è¿«æ€§ã€é‡è¦æ€§ï¼‰ã€‚</td>
                                <td class="px-6 py-4">è…¦åŠ›æ¿€ç›ªã€è¦ªå’Œåœ–</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">2</td>
                                <td class="px-3 py-4 whitespace-nowrap">è¨‚å®šæ´»å‹•è¨ˆç•«</td>
                                <td class="px-6 py-4">å‘ˆç¾ç”˜ç‰¹åœ–æˆ–æ™‚ç¨‹è¡¨ï¼Œæ¨™è¨»å„æ­¥é©Ÿé è¨ˆå®Œæˆæ™‚é–“èˆ‡åˆ†å·¥ã€‚</td>
                                <td class="px-6 py-4">ç³»çµ±åœ–ã€ç®­ç·šåœ–</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">3</td>
                                <td class="px-3 py-4 whitespace-nowrap">ç¾æ³æŠŠæ¡</td>
                                <td class="px-6 py-4">
                                    ç”¨æ•¸æ“šè­‰æ˜å•é¡Œåš´é‡æ€§ï¼Œä½¿ç”¨æŸæ‹‰åœ–ç¢ºç«‹
                                    <strong class="font-semibold">æ”»å …é‡é»</strong>ã€‚
                                </td>
                                <td class="px-6 py-4">æŸ¥æª¢è¡¨ã€æŸæ‹‰åœ–ã€å±¤åˆ¥æ³•</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">4</td>
                                <td class="px-3 py-4 whitespace-nowrap">ç›®æ¨™è¨­å®š</td>
                                <td class="px-6 py-4">
                                    è¨­å®šå…·é«”ã€å¯é‡åŒ–ã€å¯é”æˆï¼ˆ
                                    <strong>SMART</strong> åŸå‰‡ï¼‰çš„ç›®æ¨™å€¼ã€‚
                                </td>
                                <td class="px-6 py-4">åœ–è¡¨</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">5</td>
                                <td class="px-3 py-4 whitespace-nowrap">è§£æ</td>
                                <td class="px-6 py-4">ç¹ªè£½ç‰¹æ€§è¦å› åœ–ï¼Œä¸¦é‡å°ä¸»è¦è¦å› æ”¶é›†æ•¸æ“šé€²è¡Œé©—è­‰ï¼Œæ‰¾å‡º<strong class="font-semibold">çœŸå› </strong>ã€‚</td>
                                <td class="px-6 py-4">ç‰¹æ€§è¦å› åœ–ã€æ•£ä½ˆåœ–</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">6</td>
                                <td class="px-3 py-4 whitespace-nowrap">å°ç­–æ“¬å®šèˆ‡å¯¦æ–½</td>
                                <td class="px-6 py-4">åˆ—å‡ºæ‰€æœ‰å°ç­–ï¼Œèªªæ˜ç¯©é¸/è©•ä¼°æ¨™æº–ï¼Œä»¥åŠå°ç­–å¯¦æ–½çš„è©³ç´°éç¨‹ã€‚</td>
                                <td class="px-6 py-4">ç³»çµ±åœ–ã€çŸ©é™£åœ–ã€PDPC</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">7</td>
                                <td class="px-3 py-4 whitespace-nowrap">æ•ˆæœç¢ºèª</td>
                                <td class="px-6 py-4">æ¯”è¼ƒæ”¹å–„å‰å¾Œæ•¸æ“šï¼ˆæœ‰å½¢æˆæœï¼‰å’Œåœˆå“¡æˆé•·ï¼ˆç„¡å½¢æˆæœï¼‰ï¼Œèˆ‡ç›®æ¨™å€¼å°ç…§ã€‚</td>
                                <td class="px-6 py-4">åœ–è¡¨ã€ç®¡åˆ¶åœ–</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">8</td>
                                <td class="px-3 py-4 whitespace-nowrap">æ¨™æº–åŒ–</td>
                                <td class="px-6 py-4">æå‡ºå°‡æœ‰æ•ˆçš„å°ç­–ç´å…¥ SOP æˆ–è¦ç¯„çš„æ–‡ä»¶åŒ–èªªæ˜ã€‚</td>
                                <td class="px-6 py-4">æµç¨‹åœ–ã€æ–‡ä»¶åŒ–</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-3 py-4 font-medium text-fuchsia-600">9</td>
                                <td class="px-3 py-4 whitespace-nowrap">æ®˜ç•™å•é¡Œèˆ‡æœªä¾†å±•æœ›</td>
                                <td class="px-6 py-4">è‡ªæˆ‘æª¢è¨æ´»å‹•éç¨‹ï¼Œèªªæ˜æœªé”æˆçš„ç›®æ¨™æˆ–å¾…æŒçºŒæ”¹å–„çš„æ–¹å‘ã€‚</td>
                                <td class="px-6 py-4">æª¢è¨æœƒ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold text-fuchsia-700 mt-8 mb-3">ğŸ“„ å ±å‘Šæ’°å¯«æŠ€å·§ï¼š</h3>
                <ul class="list-disc list-outside ml-5 space-y-2 text-gray-600">
                    <li>
                        <strong>è¦–è¦ºåŒ–å„ªå…ˆï¼š</strong>
                        ç›¡é‡ä½¿ç”¨åœ–è¡¨ã€ç…§ç‰‡ä¾†ä»£æ›¿æ–‡å­—ï¼Œä½¿å¯©æŸ¥è€…èƒ½å¿«é€ŸæŒæ¡é‡é»ã€‚
                    </li>
                    <li>
                        <strong>æ•¸æ“šèªªè©±ï¼š</strong>
                        æ‰€æœ‰çµè«–éƒ½å¿…é ˆæœ‰æ•¸æ“šï¼ˆæŸ¥æª¢è¡¨ã€æŸæ‹‰åœ–ç­‰ï¼‰ä½œç‚ºä½è­‰ã€‚
                    </li>
                    <li>
                        <strong>éµå¾ªæµç¨‹ï¼š</strong>
                        å ±å‘Šçš„ç« ç¯€å’Œé †åºå¿…é ˆåš´æ ¼éµå¾ª QC Story çš„æ­¥é©Ÿã€‚
                    </li>
                    <li>
                        <strong>ç°¡æ½”æœ‰åŠ›ï¼š</strong>
                        é¿å…éå¤šä¸å¿…è¦çš„è´…è¿°ï¼Œæ¯å€‹æ­¥é©Ÿèšç„¦æ–¼æ ¸å¿ƒç”¢å‡ºã€‚
                    </li>
                </ul>
                <!-- AI è¼”åŠ©æå•å€å¡Š -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <h4 class="font-semibold text-lg text-gray-700 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        AI è¼”åŠ©æå•ï¼šæƒ³å•é»é—œæ–¼æ ¼å¼å—ï¼Ÿ
                    </h4>
                    <div id="chat-qcc-format">
                        <!-- Chat UI will be initialized here -->
                    </div>
                </div>
            </section>

            <!-- å€å¡Š D: åƒè€ƒè³‡æ–™ (References/Tools) - å°ˆæ³¨æ–¼å·¥å…·ä»‹ç´¹ -->
            <section id="qc-tools" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-cyan-500 mt-12">
                <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="å¸¸ç”¨å“ç®¡å·¥å…·ç¸½è¦½">ğŸ› ï¸ å¸¸ç”¨å“ç®¡å·¥å…·ç¸½è¦½ï¼ˆQC ä¸ƒæ‰‹æ³•èˆ‡æ–°ä¸ƒæ‰‹æ³•ï¼‰</h2>
                <p class="text-gray-600 mb-6">å“ç®¡å·¥å…·æ˜¯ QCC æ´»å‹•ä¸­ç”¨ä¾†æ”¶é›†ã€æ•´ç†ã€åˆ†ææ•¸æ“šèˆ‡è³‡è¨Šçš„è¼”åŠ©æ‰‹æ®µã€‚æ­£ç¢ºä½¿ç”¨å®ƒå€‘èƒ½å¤§å¤§æé«˜æ”¹å–„æ•ˆç‡ï¼</p>

                <!-- èˆŠQCä¸ƒæ‰‹æ³•è¡¨æ ¼ -->
                <h3 class="font-bold text-xl text-teal-700 mb-3 border-b pb-1">èˆŠQCä¸ƒæ‰‹æ³•ï¼ˆQC 7 Toolsï¼‰- æ•¸æ“šåˆ†æèˆ‡çµ±è¨ˆ</h3>
                <div class="overflow-x-auto rounded-lg shadow-md mb-8 border-2 border-teal-100">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-teal-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">å·¥å…·åç¨±</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">ä¸»è¦åŠŸèƒ½ï¼ˆç”¨é€”ï¼‰</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">é©ç”¨æ­¥é©Ÿ</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">æŸæ‹‰åœ– (Pareto Chart)</td><td class="px-6 py-4">æ‰¾å‡ºå½±éŸ¿æœ€å¤§çš„ã€Œé‡è¦å°‘æ•¸ã€ï¼ˆ80/20æ³•å‰‡ï¼‰ã€‚</td><td class="px-6 py-4">ç¾æ³æŠŠæ¡ã€æ•ˆæœç¢ºèª</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">ç‰¹æ€§è¦å› åœ– (Fishbone)</td><td class="px-6 py-4">ç³»çµ±æ€§æ•´ç†å•é¡Œçš„æ‰€æœ‰å¯èƒ½åŸå› ï¼ˆæ‰¾å‡ºè¦å› ï¼‰ã€‚</td><td class="px-6 py-4">è§£æ</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">æŸ¥æª¢è¡¨ (Check Sheet)</td><td class="px-6 py-4">ç³»çµ±æ€§åœ°æ”¶é›†æ•¸æ“šã€è¨˜éŒ„æ¬¡æ•¸ã€‚</td><td class="px-6 py-4">ç¾æ³æŠŠæ¡ã€æ•ˆæœç¢ºèª</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">å±¤åˆ¥æ³• (Stratification)</td><td class="px-6 py-4">å°‡æ•¸æ“šæŒ‰ä¸åŒå±¬æ€§åˆ†é¡ï¼Œé‡æ¸…å•é¡Œçš„ç™¼ç”Ÿæºã€‚</td><td class="px-6 py-4">ç¾æ³æŠŠæ¡ã€è§£æ</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">æ•£ä½ˆåœ– (Scatter Diagram)</td><td class="px-6 py-4">åˆ†æå…©çµ„æ•¸æ“šä¹‹é–“æ˜¯å¦å­˜åœ¨ç›¸é—œæ€§ã€‚</td><td class="px-6 py-4">è§£æ</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">ç®¡åˆ¶åœ– (Control Chart)</td><td class="px-6 py-4">ç›£æ§éç¨‹æ˜¯å¦è™•æ–¼ç©©å®šç‹€æ…‹ï¼Œç”¨æ–¼é•·æœŸå“è³ªç¶­æŒã€‚</td><td class="px-6 py-4">æ•ˆæœç¢ºèªã€æ¨™æº–åŒ–</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">ç›´æ–¹åœ– (Histogram)</td><td class="px-6 py-4">é¡¯ç¤ºæ•¸æ“šçš„åˆ†ä½ˆå½¢æ…‹èˆ‡é›†ä¸­è¶¨å‹¢ã€‚</td><td class="px-6 py-4">ç¾æ³æŠŠæ¡ã€æ•ˆæœç¢ºèª</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- æ–°QCä¸ƒæ‰‹æ³•è¡¨æ ¼ -->
                <h3 class="font-bold text-xl text-blue-700 mb-3 border-b pb-1">æ–°QCä¸ƒæ‰‹æ³•ï¼ˆNew QC 7 Toolsï¼‰- èªè¨€è³‡æ–™æ•´ç†èˆ‡å‰µæ–°</h3>
                <div class="overflow-x-auto rounded-lg shadow-md border-2 border-blue-100">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-blue-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">å·¥å…·åç¨±</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">ä¸»è¦åŠŸèƒ½ï¼ˆç”¨é€”ï¼‰</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">é©ç”¨æ­¥é©Ÿ</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">è¦ªå’Œåœ– (Affinity Diagram)</td><td class="px-6 py-4">æ•´ç†å¤§é‡ç™¼æ•£çš„èªè¨€è³‡æ–™/æƒ³æ³•ï¼Œé€²è¡Œåˆ†çµ„æ­¸ç´ã€‚</td><td class="px-6 py-4">ä¸»é¡Œé¸å®šã€è§£æ</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">é—œè¯åœ– (Relation Diagram)</td><td class="px-6 py-4">é‡æ¸…è¤‡é›œå•é¡Œä¸­ï¼Œå„å› ç´ ä¹‹é–“ç³¾çµçš„å› æœé—œä¿‚ã€‚</td><td class="px-6 py-4">è§£æï¼ˆè¤‡é›œåŸå› åˆ†æï¼‰</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">ç³»çµ±åœ– (Systematic Diagram)</td><td class="px-6 py-4">å°‡ç›®æ¨™ç³»çµ±æ€§åœ°åˆ†è§£ç‚ºé”æˆè©²ç›®æ¨™æ‰€éœ€è¦çš„æ‰‹æ®µã€‚</td><td class="px-6 py-4">å°ç­–æ“¬å®šã€è¨‚å®šæ´»å‹•è¨ˆç•«</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">çŸ©é™£åœ– (Matrix Diagram)</td><td class="px-6 py-4">åˆ†æå…©çµ„è¦ç´ ä¹‹é–“çš„ç›¸äº’é—œä¿‚èˆ‡å¼·åº¦ã€‚</td><td class="px-6 py-4">å°ç­–æ“¬å®š</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">éç¨‹æ±ºç­–è¨ˆç•«åœ– (PDPC)</td><td class="px-6 py-4">é æ¸¬è¨ˆç•«å¯¦æ–½ä¸­å¯èƒ½ç™¼ç”Ÿçš„å•é¡Œï¼Œé å…ˆæº–å‚™æ‡‰è®Šæªæ–½ï¼ˆé¢¨éšªé é˜²ï¼‰ã€‚</td><td class="px-6 py-4">å°ç­–å¯¦æ–½</td></tr>
                            <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">ç®­ç·šåœ–æ³• (Arrow Diagram)</td><td class="px-6 py-4">è¦åŠƒè¤‡é›œå·¥ä½œçš„æ™‚ç¨‹ï¼Œæ‰¾å‡ºé—œéµè·¯å¾‘ï¼Œæ§åˆ¶é€²åº¦ã€‚</td><td class="px-6 py-4">è¨‚å®šæ´»å‹•è¨ˆç•«</td></tr>
                        </tbody>
                    </table>
                </div>
                <!-- AI è¼”åŠ©æå•å€å¡Š -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <h4 class="font-semibold text-lg text-gray-700 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        AI è¼”åŠ©æå•ï¼šæƒ³å•é»é—œæ–¼å·¥å…·å—ï¼Ÿ
                    </h4>
                    <div id="chat-qc-tools">
                        <!-- Chat UI will be initialized here -->
                    </div>
                </div>
            </section>

        </main>

        <!-- é å°¾ -->
        <footer class="text-center py-6 mt-10 text-sm border-t border-gray-300 flex justify-between items-center">
            <p class="text-gray-500">å“è³ªæ”¹å–„æ˜¯ä¸€æ®µæŒçºŒçš„æ—…ç¨‹ã€‚ç¥æ‚¨çš„å“ç®¡åœˆæ´»å‹•é †åˆ©æˆåŠŸï¼</p>
            <div class="text-right text-gray-700 font-medium">
                <p>å¥‡ç¾é†«é™¢å“è³ªç®¡ç†éƒ¨é†«ç™‚å“è³ªç§‘ è£½</p>
                <p class="text-xs text-gray-500" id="last-updated">æœ€å¾Œæ›´æ–°æ—¥æœŸ: 2025å¹´12æœˆ01æ—¥</p>
            </div>
        </footer>

    </div>
    
    <!-- å¿«é€Ÿå›åˆ°é ‚ç«¯æŒ‰éˆ• -->
    <button id="backToTopBtn" 
            class="bg-teal-600 hover:bg-teal-700 text-white shadow-xl 
                   p-3 rounded-full flex items-center justify-center 
                   focus:outline-none focus:ring-4 focus:ring-teal-300 active:bg-teal-800 
                   transform hover:scale-105 transition duration-200"
            aria-label="å¿«é€Ÿå›åˆ°é ‚ç«¯">
        <!-- SVG å‘ä¸Šç®­é ­åœ–æ¨™ -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18" />
        </svg>
    </button>


    <script>
        // -----------------------------------------------------
        // 1. Navigation and Scroll Logic (äº’å‹•æ€§æå‡)
        // -----------------------------------------------------

        /**
         * å¹³æ»‘æ»¾å‹•è‡³ç›®æ¨™å€å¡Šä¸¦æ›´æ–°å°èˆªæŒ‰éˆ•çš„ç‹€æ…‹
         * @param {string} targetId - ç›®æ¨™å€å¡Šçš„ IDï¼ˆä¾‹å¦‚ 'qcc-steps'ï¼‰ï¼Œæˆ– 'header' å›åˆ°é ‚éƒ¨ã€‚
         * @param {string} buttonId - è¢«é»æ“ŠæŒ‰éˆ•çš„ IDã€‚
         */
        function scrollToSection(targetId, buttonId) {
            let targetElement;
            if (targetId === 'header') {
                // æ»¾å‹•åˆ°é é¢é ‚éƒ¨
                targetElement = document.querySelector('header');
            } else {
                // æ»¾å‹•åˆ°ç‰¹å®šå€å¡Š
                targetElement = document.getElementById(targetId);
            }

            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active æ¨£å¼
            document.querySelectorAll('.nav-button').forEach(button => {
                button.classList.remove('active');
            });

            // ç‚ºè¢«é»æ“Šçš„æŒ‰éˆ•åŠ ä¸Š active æ¨£å¼
            const currentButton = document.getElementById(buttonId);
            if (currentButton) {
                currentButton.classList.add('active');
            }

            if (targetElement) {
                targetElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // -----------------------------------------------------
        // 2. AI Assistant Logic (Gemini API Integration)
        // -----------------------------------------------------

        // Global configuration
        const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent";
        const apiKey = ""; // API key is provided by the environment

        /**
         * Fetches response from the Gemini API with exponential backoff.
         * @param {Array} contents - The chat history/prompt.
         * @param {string} systemInstruction - The persona and focus for the model.
         * @param {number} maxRetries - Maximum number of retries.
         * @returns {Promise<string>} - The generated text response.
         */
        async function fetchLLMResponse(contents, systemInstruction, maxRetries = 3) {
            const payload = {
                contents: contents,
                systemInstruction: { parts: [{ text: systemInstruction }] },
            };

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(`${API_URL}?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429 && i < maxRetries - 1) {
                            // Rate limit hit, apply exponential backoff
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                            await new Promise(resolve => setTimeout(resolve, delay));
                            continue; // Retry
                        }
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text || 'æŠ±æ­‰ï¼ŒAI åœ¨è™•ç†æ™‚ç™¼ç”Ÿäº†éŒ¯èª¤ã€‚';
                    return text;

                } catch (error) {
                    console.error("LLM API Error:", error);
                    if (i === maxRetries - 1) {
                        return 'æŠ±æ­‰ï¼Œç„¡æ³•é€£æ¥åˆ° AI æœå‹™ã€‚è«‹ç¨å¾Œå†è©¦ã€‚';
                    }
                }
            }
        }

        /**
         * Creates and initializes the chat UI for a specific section.
         * @param {string} containerId - The ID of the container element.
         * @param {string} sectionTitle - The title of the section for context.
         */
        function initializeChat(containerId, sectionTitle) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Chat State and History (simple local storage)
            let chatHistory = [];
            let isThinking = false;

            // UI Elements Setup
            container.innerHTML = `
                <div class="chat-display bg-gray-100 p-4 rounded-lg h-48 overflow-y-auto mb-4 border border-teal-200">
                    <div class="message text-sm text-gray-600 mb-2">
                        <span class="font-bold text-teal-600">AI åŠ©ç†ï¼š</span> æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„å“ç®¡åŠ©ç†ï¼Œè«‹é‡å°<strong class="text-teal-700">ã€${sectionTitle}ã€</strong>æå‡ºå•é¡Œã€‚
                    </div>
                </div>
                <div class="chat-input flex space-x-2">
                    <input type="text" placeholder="è¼¸å…¥æ‚¨çš„å•é¡Œ..." class="chat-text-input flex-grow p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-sm">
                    <button class="chat-send-button bg-teal-600 text-white p-2 rounded-lg hover:bg-teal-700 transition duration-150 ease-in-out font-medium text-sm disabled:opacity-50 flex items-center justify-center w-20">
                        ç™¼å•
                    </button>
                </div>
            `;

            const chatDisplay = container.querySelector('.chat-display');
            const chatInput = container.querySelector('.chat-text-input');
            const sendButton = container.querySelector('.chat-send-button');

            // System Instruction is crucial for context
            const systemInstruction = `ä½ æ˜¯ä¸€ä½å‹å–„ã€å…·å‚™æ•™å­¸ç†±å¿±çš„å“ç®¡å°ˆå®¶ã€‚è«‹æ ¹æ“šã€${sectionTitle}ã€çš„ä¸»é¡Œï¼Œå›ç­”ä½¿ç”¨è€…çš„æå•ã€‚ä½ çš„å›ç­”å¿…é ˆç°¡æ½”ã€å°ˆæ¥­ä¸”å¯Œæœ‰å•Ÿç™¼æ€§ã€‚`;

            // Function to add a message to the display
            const addMessage = (sender, text, isAi = false) => {
                const messageDiv = document.createElement('div');
                // ä½¿ç”¨ flex å’Œ justify-end/start ä¾†æ§åˆ¶å·¦å³å°é½Š
                messageDiv.className = `flex ${isAi ? 'justify-start' : 'justify-end'} mb-2`;

                const contentDiv = document.createElement('div');
                contentDiv.className = `message text-sm p-2 rounded-lg max-w-[90%] ${isAi ? 'bg-teal-100' : 'bg-indigo-100'}`;
                
                const senderSpan = document.createElement('span');
                senderSpan.className = `font-bold ${isAi ? 'text-teal-600' : 'text-indigo-600'}`;
                senderSpan.textContent = isAi ? 'AI åŠ©ç†ï¼š' : 'æ‚¨ï¼š';

                const textContent = document.createElement('p');
                textContent.className = 'ai-chat-response inline';
                textContent.innerHTML = text.replace(/\n/g, '<br>'); // Use innerHTML to respect <br>

                contentDiv.appendChild(senderSpan);
                contentDiv.appendChild(textContent);
                messageDiv.appendChild(contentDiv);

                chatDisplay.appendChild(messageDiv);
                chatDisplay.scrollTop = chatDisplay.scrollHeight; // Scroll to bottom
            };

            const handleSend = async () => {
                if (isThinking) return;

                const userText = chatInput.value.trim();
                if (userText === '') return;

                // 1. Display user message
                addMessage('user', userText, false);
                chatInput.value = '';

                // 2. Set thinking state
                isThinking = true;
                sendButton.disabled = true;
                sendButton.innerHTML = `<div class="loading-spinner"></div>`;

                // 3. Prepare chat history for API
                // Keep only the last 5 user/model turns to prevent token overflow
                const historyForApi = chatHistory.slice(-10); 
                historyForApi.push({ role: "user", parts: [{ text: userText }] });

                // 4. Call AI
                const aiResponse = await fetchLLMResponse(historyForApi, systemInstruction);

                // 5. Update full chat history
                chatHistory.push({ role: "user", parts: [{ text: userText }] });
                chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });

                // 6. Display AI message
                addMessage('ai', aiResponse, true);

                // 7. Reset thinking state
                isThinking = false;
                sendButton.disabled = false;
                sendButton.innerHTML = `ç™¼å•`;
            };

            sendButton.addEventListener('click', handleSend);
            chatInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    handleSend();
                }
            });
        }

        // -----------------------------------------------------
        // 3. Initialization on Load and Scroll Listener
        // -----------------------------------------------------
        
        // Intersection Observer ç”¨æ–¼åµæ¸¬å€å¡Šé€²å…¥è¦–çª—ï¼Œè‡ªå‹•æ›´æ–°å°èˆªæŒ‰éˆ•ç‹€æ…‹
        function setupScrollObserver() {
            const sections = [
                { id: 'what-is-qcc', buttonId: 'nav-btn-home' },
                { id: 'qcc-steps', buttonId: 'nav-btn-form' },  // âœ… ä¿®æ­£ç‚º nav-btn-form
                { id: 'qc-tools', buttonId: 'nav-btn-tools' }
            ];

            const options = {
                root: null, // viewport
                rootMargin: '0px 0px -60% 0px', // ç•¶å€å¡Šé ‚éƒ¨é€²å…¥è¦–çª—ä¸Šæ–¹ 40% æ™‚è§¸ç™¼
                threshold: 0 // åªéœ€è¦ 1px é€²å…¥å³å¯
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // æ‰¾åˆ°å°æ‡‰çš„æŒ‰éˆ• ID
                        const currentSection = sections.find(s => s.id === entry.target.id);
                        if (currentSection) {
                            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active æ¨£å¼
                            document.querySelectorAll('.nav-button').forEach(btn => {
                                btn.classList.remove('active');
                            });
                            // ç‚ºç•¶å‰å€å¡Šçš„æŒ‰éˆ•åŠ ä¸Š active æ¨£å¼
                            const btn = document.getElementById(currentSection.buttonId);
                            if (btn) btn.classList.add('active');
                        }
                    }
                });
            }, options);

            // è§€å¯Ÿæ‰€æœ‰ä¸»è¦å€å¡Š
            sections.forEach(s => {
                const element = document.getElementById(s.id);
                if (element) {
                    observer.observe(element);
                }
            });
        }
        
        // -----------------------------------------------------
        // 4. Back To Top Logic
        // -----------------------------------------------------
        function setupBackToTop() {
            const backToTopBtn = document.getElementById('backToTopBtn');
            const scrollThreshold = 300; 

            // ç›£è½é é¢æ²å‹•äº‹ä»¶
            window.addEventListener('scroll', function() {
                const scrolled = document.documentElement.scrollTop || document.body.scrollTop;
                
                if (scrolled > scrollThreshold) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });

            // æŒ‰éˆ•é»æ“Šäº‹ä»¶ï¼šå¹³æ»‘æ²å‹•åˆ°é ‚éƒ¨
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth' 
                });
            });
        }

        // -----------------------------------------------------
        // 5. iframe è¼‰å…¥é‚è¼¯ï¼šæŒ‰ä¸‹ã€Œæ›¸é¢æ ¼å¼ã€æŒ‰éˆ•æ™‚ä½¿ç”¨
        // -----------------------------------------------------
        function loadPage(page) {
            const frame = document.getElementById('content-frame');

            // 1. è¼‰å…¥é é¢
            frame.src = page;

            // 2. æ›´æ–° nav active æ¨£å¼
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            const btn = document.getElementById('nav-btn-form');
            if (btn) btn.classList.add('active');

            // 3. æ²å‹•åˆ° iframe å€å¡Šé ‚ç«¯
            frame.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }

        window.onload = function() {
            // åˆå§‹åŒ–æ‰€æœ‰ AI Chat UI
            const chatConfigs = [
                { id: 'chat-what-is-qcc', title: 'ä»€éº¼æ˜¯å“ç®¡åœˆï¼ˆQCCï¼‰ï¼Ÿ' },
                { id: 'chat-tool-selection', title: 'é‹ç”¨åˆé©çš„å“ç®¡å·¥å…·è§£æ±ºå•é¡Œï¼ˆäº”å¤§æ”¹å–„é¡å‹ï¼‰' },
                { id: 'chat-qcc-format', title: 'å“ç®¡æ”¹å–„æ­¥é©Ÿèˆ‡æ›¸é¢æ ¼å¼é‡é»' },
                { id: 'chat-qc-tools', title: 'å¸¸ç”¨å“ç®¡å·¥å…·ç¸½è¦½' }
            ];

            chatConfigs.forEach(config => {
                initializeChat(config.id, config.title);
            });
            
            // å•Ÿç”¨æ»¾å‹•è§€å¯Ÿè€…ï¼Œå¯¦ç¾è‡ªå‹•æ›´æ–°å°èˆªç‹€æ…‹
            setupScrollObserver();

            // å•Ÿç”¨å›åˆ°é ‚ç«¯æŒ‰éˆ•åŠŸèƒ½
            setupBackToTop();
            
            // ç¢ºä¿ä¸€é–‹å§‹ã€Œé¦–é ã€æŒ‰éˆ•æ˜¯ active ç‹€æ…‹
            document.getElementById('nav-btn-home').classList.add('active');
        };
    </script>

</body>
</html>
