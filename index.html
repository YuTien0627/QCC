<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>品管圈（QCC）新手入門互動指南 - 多層頁簽版</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ecfdf5;
        }
        /* 移除原頁面樣式，保留 iframe 相關樣式 */
        .nav-button {
            transition: all 0.3s ease-in-out;
            border-bottom: 3px solid transparent;
        }
        .nav-button.active {
            color: #0d9488;
            border-color: #0d9488;
            font-weight: 700;
        }
        /* 新增 iframe 樣式 */
        iframe {
            width: 100%;
            height: 80vh; /* 設置一個足夠的高度 */
            border: 1px solid #e5e7eb; /* 輕微邊框 */
            border-radius: 0.75rem; /* 圓角 */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* 陰影 */
        }
        /* 次頁簽樣式 (仿照原導航欄) */
        .sub-tabs-container {
            background-color: #f3f4f6;
            padding: 0.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            margin-bottom: 1rem;
        }
        .sub-tabs-container button {
            color: #4b5563;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .sub-tabs-container button:hover {
            background-color: #e5e7eb;
        }
        .sub-tabs-container button.active-sub {
            background-color: #d1fae5;
            color: #047857;
        }
    </style>
</head>
<body class="antialiased">

    <div class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">

        <header id="header" class="text-center py-10 bg-white shadow-xl rounded-xl mb-6 border-t-8 border-teal-600">
            <div class="flex flex-col items-center">
                <div class="flex items-center justify-center mb-2">
                    <img
                        src="https://raw.githubusercontent.com/YuTien0627/QCC/main/%E5%93%81%E7%AE%A1%E9%83%A8LOGO%20(%E5%8E%BB%E8%83%8C).png"
                        alt="奇美醫院品質管理部 Logo"
                        class="w-12 h-12 sm:w-14 sm:h-14 mr-3 object-contain"
                    >
                    <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900">
                        品管圈（QCC）新手入門互動指南
                    </h1>
                </div>
                <p class="text-xl text-gray-500">
                    從概念到實踐，品質改善的旅程由此開始！
                </p>
            </div>
        </header>

        <nav class="sticky top-0 z-10 flex justify-center bg-white p-2 rounded-xl shadow-lg mb-4 space-x-4">
            <button 
                id="nav-btn-home"
                onclick="setMainTab('home', 'main-content-home')"
                class="nav-button active text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                🚀 首頁
            </button>

            <button id="nav-btn-form"
                onclick="setMainTab('form', '書面格式_問題型.html')"
                class="nav-button text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                📝 書面格式
            </button>

            <button id="nav-btn-tools"
                onclick="setMainTab('tools', '參考資料.html')"
                class="nav-button text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                🛠️ 參考資料
            </button>

            <button id="nav-btn-quiz"
                onclick="setMainTab('quiz', '小測驗.html')"
                class="nav-button text-lg px-6 py-2 text-gray-600 hover:text-teal-600 hover:border-teal-600">
                🎯 小試身手
            </button>
        </nav>
        
        <div id="sub-tabs-container" class="sub-tabs-container flex justify-start space-x-2 hidden">
            <button id="sub-btn-problem" onclick="loadIframeContent('書面格式_問題型.html', 'sub-btn-problem')">
                問題解決型
            </button>
            <button id="sub-btn-topic" onclick="loadIframeContent('書面格式_課題型.html', 'sub-btn-topic')">
                課題達成型
            </button>
            </div>

        <main id="page-content" class="mb-10">
            <iframe id="content-frame" src="home.html" class="hidden"></iframe>

            <div id="main-content-home" class="space-y-12">
                <section id="what-is-qcc" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-teal-500 hover:shadow-2xl transition duration-300">
                    <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="什麼是品管圈（QCC）？">1.
                    什麼是品管圈（QCC）？</h2>
                    <div class="text-gray-600 leading-relaxed space-y-4">
                        <p>品管圈（Quality Control Circle, QCC）是一種持續改善活動，鼓勵<strong class="font-semibold text-teal-600">基層同仁</strong>組成小組，共同運用各種品管工具和手法，以系統性的步驟解決工作現場的問題，或達成特定的改善目標。</p>
                        <p>它不僅是一種管理工具，更是一種<strong class="font-semibold text-teal-600">品質文化</strong>的養成過程。透過這樣的活動，能培養同仁的品管意識、團隊合作能力，進而持續不斷地提升服務品質與工作效率。</p>
                    </div>
                </section>
                
                <section id="tool-selection" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-teal-500 hover:shadow-2xl transition duration-300">
                    <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="運用合適的品管工具解決問題（五大改善類型）">2.
                    運用合適的品管工具解決問題（五大改善類型）</h2>
                    <p class="text-gray-600 mb-6">品質改善活動應依據問題的性質、發生時機與目標，選擇最合適的手法和工具，以達到事半功倍的效果。</p>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="border-t-4 border-red-500 bg-red-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                            <h3 class="font-bold text-xl text-red-700 mb-2">1.
                            問題解決型（回溯）</h3>
                            <p class="text-sm font-semibold text-red-600 mb-2">處理已發生的負面落差。</p>
                            <p class="text-sm text-gray-600">
                                適用於<strong class="font-semibold">「現狀與應有狀態」之間存在負面落差</strong>的情況。目標是解決已經發生的問題，消除不良、錯誤或低效率。
                            </p>
                        </div>
                        <div class="border-t-4 border-blue-500 bg-blue-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                            <h3 class="font-bold text-xl text-blue-700 mb-2">2.
                            課題達成型（創新型）</h3>
                            <p class="text-sm font-semibold text-blue-600 mb-2">處理現狀與理想狀態的正面差距。</p>
                            <p class="text-sm text-gray-600">目標是達成更高層次的挑戰性目標，進行創新或突破現狀。</p>
                        </div>
                        <div class="border-t-4 border-green-500 bg-green-50 p-4 rounded-lg 
                        shadow-md hover:shadow-lg transition duration-300">
                            <h3 class="font-bold text-xl text-green-700 mb-2">3.
                            預先防範型（主動預防）</h3>
                            <p class="text-sm font-semibold text-green-600 mb-2">預測並消除潛在的失敗模式 (如 HFMEA)。</p>
                            <p class="text-sm text-gray-600">系統性地分析<strong class="font-semibold">新流程或高風險流程</strong>中所有潛在的失敗模式。</p>
                        </div>
                        <div class="border-t-4 border-purple-500 
                        bg-purple-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                            <h3 class="font-bold text-xl text-purple-700 mb-2">4.
                            回溯型（嚴重事件分析）</h3>
                            <p class="text-sm font-semibold text-purple-600 mb-2">針對已發生嚴重事件追溯原因 (如 RCA)。</p>
                            <p class="text-sm text-gray-600">針對<strong class="font-semibold">已發生或近乎發生的嚴重事件</strong>進行深入、系統性的分析。</p>
                        </div>
                        <div class="border-t-4 border-yellow-500 
                        bg-yellow-50 p-4 rounded-lg shadow-md hover:shadow-lg transition duration-300">
                            <h3 class="font-bold text-xl text-yellow-700 mb-2">5.
                            流程優化與改造（效率）</h3>
                            <p class="text-sm font-semibold text-yellow-600 mb-2">著重於效率、成本或動線的改善 (IE 思維)。</p>
                            <p class="text-sm text-gray-600">對現有作業流程進行診斷，找出<strong class="font-semibold">流程中的浪費、瓶頸</strong>。</p>
                        </div>
                    </div>
                </section>
            
                <section id="qcc-steps" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-fuchsia-500 mt-12">
                    <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="品管改善步驟與書面格式重點">📝 品管改善步驟與書面格式重點 (QC Story)</h2>
                    <p class="text-gray-600 mb-6">問題解決型品管圈通常遵循以下十個標準步驟，這也是您撰寫報告時的骨幹結構。</p>
                    
                    <div class="overflow-x-auto rounded-lg shadow-md border-2 border-fuchsia-100">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-fuchsia-50">
                                <tr>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-1/12">No.</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-3/12">步驟名稱</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-5/12">書面報告重點 (What to Write)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider w-3/12">關鍵工具</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">1</td>
                                    <td class="px-3 py-4 whitespace-nowrap">組圈與主題選定</td>
                                    <td class="px-6 py-4">說明團隊成員、圈名、選定主題的理由（急迫性、重要性）。</td>
                                    <td class="px-6 py-4">腦力激盪、親和圖</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">2</td>
                                    <td class="px-3 py-4 whitespace-nowrap">訂定活動計畫</td>
                                    <td class="px-6 py-4">呈現甘特圖或時程表，標註各步驟預計完成時間與分工。</td>
                                    <td class="px-6 py-4">系統圖、箭線圖</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium 
                                    text-fuchsia-600">3</td>
                                    <td class="px-3 py-4 whitespace-nowrap">現況把握</td>
                                    <td class="px-6 py-4">
                                        用數據證明問題嚴重性，使用柏拉圖確立
                                        <strong class="font-semibold">攻堅重點</strong>。
                                    </td>
                                    <td class="px-6 py-4">查檢表、柏拉圖、層別法</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium 
                                    text-fuchsia-600">4</td>
                                    <td class="px-3 py-4 whitespace-nowrap">目標設定</td>
                                    <td class="px-6 py-4">
                                        設定具體、可量化、可達成（<strong>SMART</strong> 原則）的目標值。
                                    </td>
                                    <td class="px-6 py-4">圖表</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">5</td>
                                    <td class="px-3 py-4 
                                    whitespace-nowrap">解析</td>
                                    <td class="px-6 py-4">繪製特性要因圖，並針對主要要因收集數據進行驗證，找出<strong class="font-semibold">真因</strong>。</td>
                                    <td class="px-6 py-4">特性要因圖、散佈圖</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">6</td>
                                    <td class="px-3 py-4 whitespace-nowrap">對策擬定與實施</td>
                                    <td class="px-6 py-4">列出所有對策，說明篩選/評估標準，以及對策實施的詳細過程。</td>
                                    <td class="px-6 py-4">系統圖、矩陣圖、PDPC</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">7</td>
                                    <td class="px-3 py-4 whitespace-nowrap">效果確認</td>
                                    <td class="px-6 py-4">比較改善前後數據（有形成果）和圈員成長（無形成果），與目標值對照。</td>
                                    <td class="px-6 py-4">圖表、管制圖</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">8</td>
                                    <td class="px-3 py-4 whitespace-nowrap">標準化</td>
                                    <td class="px-6 py-4">提出將有效的對策納入 SOP 或規範的文件化說明。</td>
                                    <td class="px-6 py-4">流程圖、文件化</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="px-3 py-4 font-medium text-fuchsia-600">9</td>
                                    <td class="px-3 py-4 whitespace-nowrap">殘留問題與未來展望</td>
                                    <td class="px-6 py-4">自我檢討活動過程，說明未達成的目標或待持續改善的方向。</td>
                                    <td class="px-6 py-4">檢討會</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="text-xl font-bold text-fuchsia-700 mt-8 mb-3">📄 報告撰寫技巧：</h3>
                    <ul class="list-disc list-outside ml-5 space-y-2 text-gray-600">
                        <li><strong>視覺化優先：</strong>盡量使用圖表、照片來代替文字，使審查者能快速掌握重點。</li>
                        <li><strong>數據說話：</strong>所有結論都必須有數據（查檢表、柏拉圖等）作為佐證。</li>
                        <li><strong>遵循流程：</strong>報告的章節和順序必須嚴格遵循 QC Story 的步驟。</li>
                        <li><strong>簡潔有力：</strong>避免過多不必要的贅述，每個步驟聚焦於核心產出。</li>
                    </ul>
                </section>

                <section id="qc-tools" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-l-4 border-cyan-500 mt-12">
                    <h2 class="section-title text-2xl font-bold text-gray-800 mb-4" data-section-title="常用品管工具總覽">🛠️ 常用品管工具總覽（QC 七手法與新七手法）</h2>
                    <p class="text-gray-600 mb-6">品管工具是 QCC 活動中用來收集、整理、分析數據與資訊的輔助手段。正確使用它們能大大提高改善效率！</p>

                    <h3 class="font-bold text-xl text-teal-700 mb-3 border-b pb-1">舊QC七手法（QC 7 Tools）- 數據分析與統計</h3>
                    <div class="overflow-x-auto rounded-lg 
                    shadow-md mb-8 border-2 border-teal-100">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-teal-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">工具名稱</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">主要功能（用途）</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">適用步驟</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">柏拉圖 (Pareto Chart)</td><td class="px-6 py-4">找出影響最大的「重要少數」（80/20法則）。</td><td class="px-6 py-4">現況把握、效果確認</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">特性要因圖 (Fishbone)</td><td class="px-6 py-4">系統性整理問題的所有可能原因（找出要因）。</td><td class="px-6 py-4">解析</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">查檢表 (Check Sheet)</td><td class="px-6 py-4">系統性地收集數據、記錄次數。</td><td class="px-6 py-4">現況把握、效果確認</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">層別法 (Stratification)</td><td class="px-6 py-4">將數據按不同屬性分類，釐清問題的發生源。</td><td class="px-6 py-4">現況把握、解析</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">散佈圖 (Scatter Diagram)</td><td class="px-6 py-4">分析兩組數據之間是否存在相關性。</td><td class="px-6 py-4">解析</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">管制圖 (Control Chart)</td><td class="px-6 py-4">監控過程是否處於穩定狀態，用於長期品質維持。</td><td class="px-6 py-4">效果確認、標準化</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">直方圖 (Histogram)</td><td class="px-6 py-4">顯示數據的分佈形態與集中趨勢。</td><td class="px-6 py-4">現況把握、效果確認</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="font-bold text-xl text-blue-700 mb-3 border-b pb-1">新QC七手法（New QC 7 Tools）- 語言資料整理與創新</h3>
                    <div class="overflow-x-auto rounded-lg shadow-md border-2 border-blue-100">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-blue-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">工具名稱</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">主要功能（用途）</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">適用步驟</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 text-sm text-gray-700">
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">親和圖 (Affinity Diagram)</td><td class="px-6 py-4">整理大量發散的語言資料/想法，進行分組歸納。</td><td class="px-6 py-4">主題選定、解析</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">關聯圖 (Relation Diagram)</td><td class="px-6 py-4">釐清複雜問題中，各因素之間糾結的因果關係。</td><td class="px-6 py-4">解析（複雜原因分析）</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">系統圖 (Systematic Diagram)</td><td class="px-6 py-4">將目標系統性地分解為達成該目標所需要的手段。</td><td class="px-6 py-4">對策擬定、訂定活動計畫</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">矩陣圖 (Matrix Diagram)</td><td class="px-6 py-4">分析兩組要素之間的相互關係與強度。</td><td class="px-6 py-4">對策擬定</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">過程決策計畫圖 (PDPC)</td><td class="px-6 py-4">預測計畫實施中可能發生的問題，預先準備應變措施（風險預防）。</td><td class="px-6 py-4">對策實施</td></tr>
                                <tr class="hover:bg-gray-50"><td class="px-6 py-4 font-medium whitespace-nowrap">箭線圖法 (Arrow Diagram)</td><td class="px-6 py-4">規劃複雜工作的時程，找出關鍵路徑，控制進度。</td><td class="px-6 py-4">訂定活動計畫</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>


        <footer class="text-center py-6 mt-10 text-sm border-t border-gray-300 flex justify-between items-center">
            <p class="text-gray-500">品質改善是一段持續的旅程。祝您的品管圈活動順利成功！</p>
            <div class="text-right text-gray-700 font-medium">
                <p>奇美醫院 品質管理部 醫療品質科 製作</p>
                <p class="text-xs text-gray-500" id="last-updated">最後更新時間: （讀取中...）</p>
            </div>
        </footer>

    </div>
    
    <button id="backToTopBtn" 
            class="bg-teal-600 hover:bg-teal-700 text-white shadow-xl 
                   p-3 rounded-full flex items-center justify-center 
                   focus:outline-none focus:ring-4 focus:ring-teal-300 active:bg-teal-800 
                   transform hover:scale-105 transition duration-200"
            aria-label="快速回到頂端">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18" />
        </svg>
    </button>

    <script>
        // ========== 邏輯：切換主頁籤與次頁籤顯示 ==========
        const homeContent = document.getElementById('main-content-home');
        const iframe = document.getElementById('content-frame');
        const subTabsContainer = document.getElementById('sub-tabs-container');

        // 切換主頁籤 active 狀態
        function setActive(buttonId) {
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            const btn = document.getElementById(buttonId);
            if (btn) btn.classList.add('active');
        }

        // 切換次頁籤 active 狀態
        function setSubActive(buttonId) {
            document.querySelectorAll('#sub-tabs-container button').forEach(btn => {
                btn.classList.remove('active-sub');
            });
            const btn = document.getElementById(buttonId);
            if (btn) btn.classList.add('active-sub');
        }


        // 切換主頁籤內容（載入 iframe 或顯示 home 內容）
        function setMainTab(tabName, pageUrl) {
            setActive(`nav-btn-${tabName}`);
            
            // 隱藏所有內容
            homeContent.classList.add('hidden');
            iframe.classList.add('hidden');
            subTabsContainer.classList.add('hidden');
            
            if (tabName === 'home') {
                // 顯示 home 內容
                homeContent.classList.remove('hidden');
            } else {
                // 顯示 iframe 並載入內容
                iframe.classList.remove('hidden');
                iframe.src = pageUrl;

                // 判斷是否顯示次頁簽
                if (tabName === 'form') { // 假設只有 '書面格式' 有次頁籤
                    subTabsContainer.classList.remove('hidden');
                    // 預設讓第一個次頁簽 active
                    setSubActive('sub-btn-problem');
                }
            }

            // 捲動到頂部
            document.getElementById('header').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // 載入次頁簽內容到 iframe
        function loadIframeContent(pageUrl, buttonId) {
            iframe.src = pageUrl;
            setSubActive(buttonId);
        }
        
        // ========== 回到頂端按鈕 ==========
        function setupBackToTop() {
            const backToTopBtn = document.getElementById('backToTopBtn');
            const scrollThreshold = 300; 

            window.addEventListener('scroll', function() {
                const scrolled = document.documentElement.scrollTop || document.body.scrollTop;
                if (scrolled > scrollThreshold) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth' 
                });
            });
        }

        // ========== 最後更新時間：使用檔案最後修改時間 ==========
        function updateLastUpdated() {
            const lastModifiedStr = document.lastModified;
            const lastModifiedDate = new Date(lastModifiedStr);

            if (isNaN(lastModifiedDate.getTime())) {
                console.warn('無法解析 document.lastModified：', lastModifiedStr);
                return;
            }

            const formatter = new Intl.DateTimeFormat('zh-TW', {
                timeZone: 'Asia/Taipei',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });
            const parts = formatter.formatToParts(lastModifiedDate);
            const get = type => parts.find(p => p.type === type)?.value || '';

            const year = get('year');
            const month = get('month');
            const day = get('day');
            const hour = get('hour');
            const minute = get('minute');

            const el = document.getElementById("last-updated");
            if (el) {
                el.textContent = `最後更新時間（中原標準時間）: ${year}年${month}月${day}日 ${hour}:${minute}`;
            }
        }

        // ========== 初始化 ==========
        function initPage() {
            // 預設顯示首頁內容
            setMainTab('home', 'main-content-home');
            setupBackToTop();
            updateLastUpdated();
        }

        window.addEventListener('load', initPage);
    </script>

</body>
</html>
